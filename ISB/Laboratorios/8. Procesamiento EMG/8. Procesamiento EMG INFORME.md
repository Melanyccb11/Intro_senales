<h1 style="text-align: center;">Laboratorio 6: Filtrado de Señales Biológicas</h1>

</h3>Nombre de los Integrantes y código:

1. Melany Cama Bahamonde 72128361
2. Alessandra Valle Montoya  71098563
3. Catherine Boggio Vidal 71329106
4. Juan Jose Sandoval Barrantes 74145560
</p>

<h2 style="text-align: center;">Tabla de Contenidos</h2>

1. [Objetivos](#objetivo)
2. [Introducción](#intro)
3. [Materiales y equipos](#matereiales)
4. [Metodología](#metodo)
5. [Archivo de los datos de la señal ploteada](#archivosenal)
6. [Ploteo de la señal en Python](#python)
7. [Resumen y Discusión](#explic)
8. [Bibliografía](#Bibliografía)

<a id = "objetivo" style></a>
<h2 style = "text-align: center;">Objetivos</h2>
- Diseñar Filtros Digitales<br />
- Filtrar las Señales de ECG, EMG, EGG en diferentes Estados Fisiológicos<br />
- Analizar los resultados obtenidos de las filtraciones.<br />


<a id = "intro" style></a>
<h2 style = "text-align: center;">Introducción</h2>

En la adquisición de señales médicas, la precisión y la eficiencia son aspectos relevantes para extraer información de las señales biológicas. En este contexto, el diseño de filtros digitales se convierte en una herramienta fundamental para mejorar la calidad de las mediciones, eliminar ruidos no deseados y resaltar características específicas de interés en señales como el electrocardiograma (ECG) [1] , el electromiograma (EMG) [2] y el electroencefalograma (EEG) [3]. Por ello, existen diferentes filtros que se encargan de eliminar los ruidos obtenidos a la hora de adquirir las señales, en este laboratorio se hará uso de los siguientes filtros:

### Filtros FIR (Respuesta al Impulso Finita):

Es un tipo de filtro digital que se caracteriza por tener una respuesta al impulso (la respuesta del filtro a una entrada de impulso unitario) que es de duración finita, porque se asienta a cero en un tiempo finito.Este tipo de filtros tiene la propiedad de ser siempre estables, lo que los hace muy útiles en diversas aplicaciones de procesamiento de señales. Los filtros FIR pueden ser diseñados para tener una respuesta de fase lineal, lo que significa que todas las frecuencias en la banda de paso del filtro serán desplazadas en el tiempo (o retrasadas) por la misma cantidad.
La ecuación general para un filtro FIR de orden N es:

 </p>
<p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ecuaci%C3%B3n%20FIR.png">
<h5 align="center">
  <i>Figura 1. Ecuación general para un filtro FIR de orden N </i></div>
<br /> </p>
 <div align="center"> <i>Donde:</i></div>
<p>
 y[n]: salida del filtro<br />
h[k]: coeficientes del filtro<br />
x[n-k]: son las entradas al filtro<br />
</i></div>
</h5>

Los coeficientes h[k] definen la respuesta al impulso del filtro y determinan las propiedades de frecuencia del filtro. Estos coeficientes pueden ser calculados utilizando varias técnicas de diseño de filtros, como el método de ventanas, el método de frecuencia de muestreo, entre otros [4], [5].

 </p>
<p align="center">
 <img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/FIR%20IMAGE.jpg">
<h5 align="center">
  <i>Figura 2. Diagrama de bloques de un filtro de respuesta finita al impulso (FIR) que utiliza tres retardos y coeficientes ajustables 𝐴0, 𝐴1, 𝐴2, etc [5].</i></div>

####  Método de ventanas:

1. Rectangular: Es la ventana más simple y consiste en tomar un segmento de la señal y considerarlo tal cual, sin aplicar ninguna ponderación. Tiene la mejor resolución en frecuencia porque el ancho del lóbulo principal es el más estrecho, permitiendo detectar frecuencias cercanas entre sí. Sin embargo, produce el mayor nivel de lóbulos secundarios, que resulta en un considerable rizado en el dominio de la frecuencia. Esto puede causar problemas como el aliasing cuando se utiliza en aplicaciones sensibles a las frecuencias no deseadas [4].
2. Hamming: Posee un lóbulo principal de ancho similar al de la ventana de Hanning que equilibra la resolución en frecuencia con la supresión de la fuga espectral. La ventana minimiza efectos de borde al aproximarse a cero en los extremos y aunque sus lóbulos laterales son propensos al aliasing, presenta una mejor atenuación del primer lóbulo lateral y una variación más uniforme en la amplitud de los lóbulos laterales, lo que es ventajoso para ciertas aplicaciones de análisis espectral [6].
3. Hanning: Con una atenuación del primer lóbulo de -31 dB y un decaimiento de los lóbulos laterales a una tasa de 18 dB por octava, la ventana de Hann ofrece una supresión más efectiva de las frecuencias no deseadas en comparación con la ventana rectangular, siendo ideal para aplicaciones donde la calidad espectral es prioritaria [6], [7].
4. Blackman: Ofrece una excelente atenuación de los lóbulos secundarios, mucho mejor que las ventanas Hanning y Hamming, pero a expensas de un lóbulo principal más ancho. Esto la hace menos ideal para detectar frecuencias cercanas entre sí, pero excelente para aplicaciones donde la supresión de los lóbulos secundarios es crítica.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ventanas%20fir.png"/>
<div align="center"> 
 <h5 align="center">
 <i>Figura 3. Comparación de ventanas creadas para aplicarlas en filtros FIR [4].</i></div>
<p>
 
</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/tipos%20de%20ventana%20y%20anchura%20FIR.png"> 
<h5 align="center">
  <i>Figura 4. Características en el dominio de frecuencia de las ventanas [4].</i></div>
<p>


### Filtros IIR (Respuesta al Impulso Infinita): 

Filtro recursivo que calcula su salida utilizando tanto las entradas actuales como las anteriores y las salidas previas. Este tipo de filtro incorpora un mecanismo de retroalimentación debido al uso de valores anteriores de la salida en su estructura. El diseño del filtro IIR implica determinar la función de transferencia de pulso que cumpla con los criterios especificados para el filtro. Este diseño se puede realizar desarrollando primero un prototipo analógico y luego transformándolo a una función de transferencia de pulso, o diseñando directamente en el dominio digital [4], [7].

 </p>
<p align="center">
 <img width="500" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/IIR%20FILTER%20IMAGE.gif">
<h5 align="center">
  <i>Figura 5. Arquitectura de los filtros IIR [7].</i></div>

#### Tipos de filtro:

1. Bessel: Se usan para reducir la distorsión de fase no lineal en filtros IIR. Tienen una respuesta máximamente plana en magnitud y fase, lo que significa una atenuación uniforme en todas las frecuencias y una fase casi lineal en la banda de paso. Sin embargo, necesitan filtros de alto orden, lo que limita su uso. Son preferidos cuando se requiere una atenuación uniforme y una transición suave entre la banda de paso y la de parada [8].
2. Butterworth: tienen una respuesta suave en todas las frecuencias y disminuyen de manera constante desde las frecuencias de corte. Son "maximally flat", con una respuesta ideal de unidad en la banda de paso y cero en la banda de parada. Aunque su transición entre la banda de paso y la banda de parada es lenta, ofrecen una respuesta de frecuencia suave y constante. La empinada transición aumenta con el orden del filtro, lo que permite aproximarse a la respuesta ideal del filtro paso bajo [9] .
3. Chebyshev: Minimiza el error máximo en la banda de paso al permitir ondulaciones equirrítmicas en esta región. Tienen una respuesta en magnitud monótonamente decreciente en la banda de parada y una pendiente de atenuación más pronunciada que los filtros de Butterworth. La frecuencia de corte para los filtros de Chebyshev se define como el final de la banda de paso, donde la respuesta está 1 dB por debajo de su nivel máximo y decrece monótonamente más allá de este punto [10].
4. Elíptica (Cauer): La ventana elíptica se utiliza para diseñar filtros con una respuesta en frecuencia óptima en términos de selectividad y ancho de banda de transición, a costa de tener ondulaciones tanto en la banda de paso como en la banda de parada. Es ideal para aplicaciones donde se requiere un alto grado de selectividad y una rápida transición entre la banda de paso y la banda de parada, como en filtros de alta frecuencia y sistemas de sonar.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/iir%20windows.png" align="center" width="660" height="500"/>
<div align="center">
 <h5 align="center">
 <i>Figura 6. Filtros IIR [X].</i></div>
<p>

  

<a id = "matereiales"></a>  
<h2 style = "text-align: center;">Materiales y equipos</h2>

<div align="center">

|   **Dispositivo**   | **Descripción** |  **Imagen**  |
|:-------------------:|:---------------:|:------------:|
|      laptop      | Una laptop equipada con Python, un lenguaje de programación versátil y poderoso, es ideal para realizar tareas de programación y análisis de datos en entornos de laboratorio. |<img width="200" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/68af906e-92c2-4096-ab4c-06e60cba53f1.jpg">|

</div>


<a id = "metodo" style></a>
<h2 style = "text-align: center;">Metodolodía</h2>

### Metodología General
</p>

1. Preparación y Entendimiento de Datos:
   - Revisar los datasets disponibles para cada ejercicio para entender las características y el formato de los datos.
   - Identificar las señales crudas que serán procesadas en cada laboratorio.
2. Diseño de Filtros:
   - Definir las características y especificaciones técnicas de cada filtro requerido para el ECG, EMG y EEG.
   - Utilizar herramientas como Python y librerías específicas para el diseño y la implementación de filtros FIR e IIR.
3. Aplicación de Filtros y Análisis de Resultados:
   - Aplicar los filtros diseñados a las señales crudas y generar señales filtradas.
   - Visualizar y comparar las señales antes y después del filtrado para evaluar la efectividad de cada filtro.
4. Documentación y Reporte:
   - Preparar informes detallados con resultados, visualizaciones y discusión sobre la efectividad de los filtros.
   - Organizar los códigos fuente y resultados para la subida a la plataforma de GitHub.

</p>

### Metodología Específica - Laboratorios 
</p>

#### ECG:
1. Selección de Filtro IIR:
   - Diseñar un filtro IIR con opciones como Bessel, Butterworth, Chebyshev o Elíptico, para filtrar en frecuencias altas.
2. Selección de Filtro FIR:
   - Elegir dos métodos de ventana (Hanning, Hamming, Bartlett, rectangular o Blackman) para un filtro FIR.
   - Diseñar el filtro FIR con una frecuencia de corte adecuada para el contexto del ECG.
3. Visualización y Reporte:
   - Crear gráficos comparativos para cada estado ('Basal', 'Respiración', 'Post-ejercicio') con la señal cruda, filtrada con IIR y filtrada con FIR.

#### EMG:
1. Selección de Filtro IIR:
   - Elegir un tipo de filtro IIR para eliminar frecuencias altas que corresponden a ruido eléctrico y artefactos.
2. Selección de Filtro FIR:
   - Diseñar un filtro FIR utilizando ventanas como Hamming o Blackman, enfocado en aislar la banda de frecuencia que corresponde a la actividad muscular.
   - Especificaciones: Fc = 50 Hz, paso banda bajo.
3. Visualización y Reporte:
   - Crear gráficos comparativos con los campos de actividad ('Descanso', 'Contracción leve', 'Contracción fuerte').

#### EEG:
1. Selección de Filtro IIR:
   - Implementar un filtro IIR para suprimir interferencias de alta frecuencia.
2. Selección de Filtro FIR:
   - Utilizar métodos de ventana para diseñar un filtro FIR que extraiga bandas de frecuencia específicas (alfa, beta).
   - Especificaciones: Fc = 12 Hz, paso banda para ondas específicas.
3. Visualización y Reporte:
   - Generar gráficos comparativos con estados de 'Vigilia', 'Abrir y cerrar ojos con un patrón', 'Resolviendo problemas matemáticos'.
    
</p>

<a id = "archivosenal"></a>
<h2 style = "text-align: center;">Archivos de los datos de la señal ploteada</h2>
</h5>

#### ECG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/NormalBreath30s.txt)</p>
2. [Registro 2 - Bitalino: Inhalando/Manteniendo/Exhalando por 5s](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/InHoldEx5s.txt)</p>
3. [Registro 3 - Bitalino: Después del burpee](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/ReposandoBurpee30s.txt)</p>
#### EEG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_PrimeroOsjoscerrados.txt)</p>
2. [Registro 2 - Bitalino: Abriendo/Cerrando ojos](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_2_5s.txt)</p>
3. [Registro 3 - Bitalino: Resolviendo ejercicios](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/ejmate.txt)</p>
#### EMG
1. [Registro 1 - Bitalino: Reposo/ontracción leve/ontracción fuerte](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/3.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EMG/text_EMG.txt)</p>

### Archivos python 

1. [Código principal - IIR y FIR ](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Filtros_lab6.ipynb)</p>


<a id = "python"></a>
<h2 style = "text-align: center;">Ploteo de la señal en Python</h2>
</p>

En el análisis de señales biológicas, la elección de filtros es crucial para resaltar características relevantes y eliminar ruido no deseado. En este estudio, se explorarán filtros IIR (Infinite Impulse Response) y FIR (Finite Impulse Response) con diferentes frecuencias de corte, adaptándose a los parámetros específicos de cada señal biológica evaluada. Se examinará cómo estos filtros influyen en la interpretación de las señales filtradas, considerando aspectos como la preservación de características importantes y la atenuación del ruido. Al concluir, se determinará qué tipo de filtro, ya sea IIR o FIR, se adapta mejor a las necesidades particulares de procesamiento de la señal biológica en cuestión, proporcionando una base sólida para futuros análisis y diagnósticos.
</p>
Comenzamos realizando la FFT de la señal original que nos permite analizar el dominio de la frecuencia en el dominio del tiempo. Esta información es esencial para el diseño y la implementación de técnicas de filtrado eficaces, ya que nos proporciona una base sólida para identificar y atenuar selectivamente las componentes de frecuencia no deseadas.</p>


## Para las señales de ECG 
Se realiza la elección de los filtros FIR e IIR, en el caso de del ECG, se eligen:
1. Selección de Filtro IIR:
   - Para mitigar el ruido presente en las señales adquiridas de electrocardiograma (ECG) en el laboratorio 4, hemos empleado el filtro Butterworth. Este tipo de filtro ha demostrado ser altamente efectivo en la eliminación del ruido de las señales de ECG afectadas [11]. Al observar la gráfica, podemos apreciar una notable reducción del ruido en comparación con la señal original. Este resultado se atribuye principalmente a la elección de la frecuencia de corte y al orden del filtro [12]. En nuestro estudio, hemos diseñado un filtro con una frecuencia de corte de 50 Hz y un orden de 4. No obstante, al aplicar el filtro, hemos observado una disminución en la amplitud de las ondas R y T. Este efecto se debe al orden del filtro seleccionado. Sin embargo, gracias a la frecuencia de corte, hemos notado una mejora significativa en la nitidez del complejo QRS [12].
2. Selección de Filtro FIR:
   - Además, implementamos un filtro FIR utilizando la ventana de Hamming y Blackman, con una frecuencia de corte de 50 Hz y con un orden de 101 [14]. Esta ventana se caracteriza por tener lóbulos laterales cercanos a cero, lo que significa que reduce significativamente la fuga de energía de la señal fuera de la banda de interés. Este enfoque ayuda a mejorar la selectividad del filtro y a minimizar la distorsión de la señal de interés [14]. Sin embargo, al representar gráficamente la señal filtrada, observamos un aumento en la amplitud dentro del intervalo ST, en comparación con la señal original, y también se detecta un retraso de la señal con respecto a la original. Este comportamiento puede ser atribuido al error y al retraso inherentes al filtro utilizado, a pesar de ello cumple con la función de filtrar la señal. [14].

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 7. Filtros para la señal de ECG. [Elaboración propia]</i></div>
<p>



### Reposo :
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT.jpg"> 
<h5 align="center">
  <i>Figura 8. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura 9: Señal obtenida en python: Actividad en reposo.[Elaboración propia]
</h5>

#### Interpretación[15]:
1. Picos agudos en la señal original: Estos picos se observan claramente alrededor de los 20.50 segundos y 21.50 segundos. Estos probablemente corresponden a los complejos QRS, que son indicativos de la actividad eléctrica del corazón asociada con la contracción de los ventrículos. Son las características más notables en una señal de EKG y representan un punto de análisis crucial.
2. Respuesta de los filtros:
- FIR filtro Hamming: La señal filtrada con Hamming muestra una suavización de la señal pero sigue reflejando los picos, aunque con menos ruido y variaciones menores entre los picos.
- FIR filtro Blackman: Similar al filtro Hamming, este filtro también suaviza la señal pero mantiene una amplitud considerable en los picos QRS, mostrando una buena preservación de las características importantes del EKG.
- IIR filtro Butterworth: Este filtro muestra una respuesta más variable. Mientras que filtra bastante ruido, también parece alterar un poco más la amplitud y la forma de los picos QRS, especialmente notable alrededor de los 21.50 segundos donde el pico parece más distorsionado en comparación con los filtros FIR.
  
La ventana de interés más significativa estaría centrada alrededor de estos picos QRS, ya que son esenciales para analizar el ritmo cardíaco y la actividad eléctrica del corazón. Estos segmentos, específicamente alrededor de 20.50 y 21.50 segundos, serían los puntos focales para un análisis más detallado de la señal de reposo.

### Inhalando/Manteniendo/Exhalando por 5s
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT2.jpg"> 
<h5 align="center">
  <i>Figura 10. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_IN_HOLS_EX.jpg">
</p>
<h5 align="center">
  Figura 11: Señal obtenida en python: Inhalando/Manteniendo/Exhalando por 5s. [Elaboración propia]
</h5>

#### Interpretación[15]:

En la nueva gráfica, las ventanas de interés pueden identificarse alrededor de los picos más prominentes en la señal original, que son visibles cerca de los 20.50 segundos y 21.50 segundos. Estos picos, que probablemente representan los complejos QRS, son momentos clave en un EKG ya que indican la actividad eléctrica de los ventrículos del corazón.

- FIR filtro Hamming y FIR filtro Blackman: Ambos filtros han suavizado la señal, pero aún conservan las características de los picos, haciendo que estas características sean claramente visibles, aunque con una amplitud algo reducida. Estos filtros están logrando una buena balance entre reducir el ruido y preservar la información importante de los picos QRS.
- IIR filtro Butterworth: Este filtro muestra una reducción significativa en el ruido de la señal y una preservación adecuada de los picos, aunque con un efecto de suavizado más pronunciado que podría afectar la nitidez de los picos QRS.

La ventana de interés para un análisis más detallado sería entre 20.25 segundos y 21.75 segundos, abarcando ambos picos QRS y permitiendo evaluar la eficacia del filtro en preservar la integridad de estos importantes eventos cardíacos mientras reduce el ruido circundante.

### Después del ejercicio físico
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT3.jpg"> 
<h5 align="center">
  <i>Figura 12. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_POST-BURPEE.jpg">
</p>
<h5 align="center">
  Figura 13. Señal obtenida en python: Después del ejercicio físico. [Elaboración propia]
</h5>

#### Interpretación[15]:

En esta gráfica después de realizar un ejercicio físico, las ventanas de interés son claramente visibles alrededor de los picos más altos de la señal original, que se producen cerca de los 2.50 segundos y 3.25 segundos. Estos picos son indicativos de los complejos QRS, que son cruciales para analizar la actividad eléctrica del corazón, especialmente después del ejercicio.

- FIR filtro Hamming: Muestra una suavización significativa de la señal con menos ruido, pero aún conserva la forma de los picos QRS, lo que es esencial para mantener la información diagnóstica relevante.
- FIR filtro Blackman: Similar al filtro Hamming, también suaviza la señal mientras preserva los picos, aunque con una ligera distorsión en la forma y la amplitud de los picos.
- IIR filtro Butterworth: Este filtro muestra una respuesta más suave con cierta distorsión en los picos QRS, lo que podría ser relevante al analizar cómo afecta el ejercicio a la señal cardíaca.

La ventana de interés para el análisis detallado en este caso se extendería desde aproximadamente los 2.25 segundos hasta los 3.50 segundos, abarcando ambos picos QRS principales. Este rango incluye los eventos cardíacos más significativos en el periodo post-ejercicio, permitiendo una evaluación efectiva de cómo el ejercicio ha influido en la actividad eléctrica del corazón.

## Para las señales de EEG 

Se realiza la elección de los filtros FIR e IIR, en el caso de del EEG, se eligen:
1. Selección de Filtro IIR:
   - Para las señales en EEG, al igual que en ECG, elegimos para los filtros IIR el Butterworth de cuarto orden, ya que este es comúnmente utilizado para el procesamiento de señales de EEG con el fin de filtrar y eliminar componentes no deseados . En las gráficas podemos observar que las señales se atenúan sin tener un delay, sin embargo hay un cambio en su amplitud[16]. 
2. Selección de Filtro FIR:
   - En el caso de los filtros FIR se usó la ventana Bartlett, la cual una de las propiedades que tiene es la de mitigar fugas espectrales y la varianza en el espectro obtenido. Es decir que el efecto que tiene esta ventana es la de una señal de EEG con una representación más precisa y una representación más constante en el tiempo para poder realizar un mejor análisis de la señal [17].  

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 14. Filtros para la señal de EEG. [Elaboración propia]</i></div>
<p>

### Reposo :

Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT1.jpg"> 
<h5 align="center">
  <i>Figura 15. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura 16. Señal obtenida en python: Actividad en reposo. [Elaboración propia]
</h5>



#### Interpretación:

Como podemos observar en las gráficas que hemos obtenido en la parte de reposo el número de picos por segundo es igual a 12 aproximadamente, lo que indica que el sujeto está en un estado de meditación y relajación [18].




### Abrir y cerrar los ojos  5s 

Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT2.jpg"> 
<h5 align="center">
  <i>Figura 17. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_ABR_CER_OJOS.jpg">
</p>
<h5 align="center">
  Figura 18. Señal obtenida en python: Abrir y cerrar los ojos  5s c/u.[Elaboración propia]
</h5>

#### Interpretación:

Por otro lado en la gráfica donde cierra y abre los ojos podemos ver una onda de mayor amplitud y duración en el tiempo lo que puede indicar que es en el momento donde pasó de cerrado a abierto[18]. 


### Resolviendo ejercicios matematicos 
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT3.jpg"> 
<h5 align="center">
  <i>Figura 19. FFT de la señal [Elaboración propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600"src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_MATE.jpg">
</p>
<h5 align="center">
  Figura 20. Señal obtenida en python: Resolviendo ejercicios matematicos. [Elaboración propia]
</h5>

#### Interpretación:

Por último tenemos que en el apartado donde se resuelven ejercicios, como se comentó en la anterior entrega nuestra participante al realizarle la pregunta no supo qué decir al instante. Por lo que no realizó el ejercicio mental y por ello salen ondas betas en la gráfica [18].



## Para las señales de EMG 

Primero sacamos la DFT, en donde determinamos que una óptima frecuencia de corte es 50 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_FFT.jpg"> 
<h5 align="center">
  <i>Figura 21. FFT de la señal [Elaboración propia].</i></div>
 </h5>
<p>
</br>



Se realiza la elección de los filtros FIR e IIR, en el caso de del ECG, se eligen:
1. Selección de Filtro IIR:
   - El uso del filtro Butterworth logra una reducción efectiva del ruido en las señales de EMG, proporcionando resultados comparables a los modelos más complejos y específicos del sujeto, pero con una implementación más sencilla y menos costosa [19]. Es por ese motivo que también utilizamos este filtro en EMG y lo podemos comprobar con las gráficas que obtuvimos tras aplicarlo.

2. Selección de Filtro FIR:
   - El uso de filtros de ventana la ventana Hamming atenúa el ruido y mejora la calidad de la señal. Estos filtros reducen las fuentes de interferencia electromagnética y artefactos de movimiento, mejorando así la precisión de las mediciones EMG al minimizar la contaminación espectral de frecuencias no deseadas. Y es lo que podemos apreciar en las siguientes gráficas [20].


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 22. Filtros para la señal de EMG.[Elaboración propia]</i></div>
<p>


### Reposo :

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_REPOSO.jpg">
</p>
<h5 align="center">
  <i>Figura 23. Señal obtenida en python: Actividad en reposo. [Elaboración propia]</i></div>
</h5>



#### Interpretación [21]:

- En la gráfica para la señal EMG, parece que hay una sección claramente diferenciada donde se muestra una actividad considerablemente mayor comparada con el resto de la señal. Esta sección se caracteriza por un aumento en la amplitud y la variabilidad de la señal, y está ubicada entre aproximadamente 2 segundos y 8 segundos en el eje de tiempo.

- Esta ventana, que muestra una alta actividad muscular, probablemente es el segmento de interés donde se esperaría que los filtros IIR y FIR tengan un impacto significativo en el procesamiento de la señal para reducir ruido y otros artefactos, mientras se mantiene la información muscular esencial. Observando las líneas de las señales filtradas (IIR y FIR), parece que los filtros han sido aplicados a toda la señal, pero es en esta ventana donde su efecto sería más crucial para evaluar, ya que es donde la señal es más prominente y potencialmente más susceptible al ruido y a las fluctuaciones no deseadas.


### Contracción leve

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CON_LEVE.jpg">
</p>
<h5 align="center">
  Figura 24. Señal obtenida en python: Contracción leve. [Elaboración propia]
</h5>

#### Interpretación[21]:

- En esta nueva gráfica, al observar la actividad más significativa, parece que la ventana de interés, donde la señal muestra mayor variabilidad y amplitud, está comprendida aproximadamente entre los 13.6 segundos y los 15.0 segundos en el eje del tiempo.

- Dentro de este intervalo, se pueden notar picos más altos y una mayor fluctuación en la señal original (en azul), lo cual es típico en segmentos de actividad muscular activa o momentos de artefactos. La señal filtrada con el filtro IIR (en rosa) muestra una reducción notable en la variabilidad y mantiene una amplitud más constante, lo que indica que el filtro ha suavizado eficazmente la señal. Por otro lado, la señal filtrada con el filtro FIR (en verde) también muestra una forma más suave comparada con la señal original, conservando un perfil que sigue de cerca las fluctuaciones de la señal original pero con una reducción en el ruido de alta frecuencia.

- Estos resultados sugieren que ambos filtros están trabajando como se espera en esta ventana, reduciendo el ruido y suavizando la señal sin eliminar completamente la información subyacente de la actividad muscular. Esto sería el foco principal de análisis para evaluar la efectividad del filtrado aplicado.

### Contracción fuerte
</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CONT_FUERTE.jpg">
</p>
<h5 align="center">
  Figura 25. Señal obtenida en python: Contracción fuerte. [Elaboración propia]
</h5>

#### Interpretación[21]:

- En esta gráfica observamos varias secciones con diferentes niveles de actividad. La ventana de interés parece ser entre los 16.5 segundos y 17.5 segundos en el eje del tiempo. Durante este intervalo, se aprecia un aumento significativo en la amplitud y variabilidad de la señal original (en azul), lo que indica una mayor actividad muscular en comparación con las regiones antes y después de este intervalo.

- Las señales filtradas con filtros IIR (en rosa) y FIR (en verde) muestran una reducción en la amplitud de las fluctuaciones y una señal más suavizada, pero todavía siguen los patrones generales de la señal original dentro de esta ventana. Esto indica que ambos filtros están efectivamente atenuando el ruido y otros componentes de alta frecuencia, mientras preservan la forma de la señal muscular subyacente en este segmento.

<a id = "explic"></a>
<h2 style = "text-align: center;">Resumen y Discusión</h2>

El estudio realizado se enfoca en el diseño y la implementación de filtros digitales FIR (Respuesta al Impulso Finita) e IIR (Respuesta al Impulso Infinita) para el procesamiento de señales médicas, específicamente el electrocardiograma (ECG), el electromiograma (EMG) y el electroencefalograma (EEG). La precisión y la eficiencia en la extracción de información de estas señales son aspectos fundamentales, y los filtros juegan un papel crucial en mejorar la calidad de las mediciones, eliminando ruidos no deseados y resaltando características específicas[12-21].

En el laboratorio, se exploraron diferentes tipos de filtros FIR, como el método de ventanas, que incluye opciones como rectangular, Hamming, Hanning y Blackman, y filtros IIR, como Butterworth, Bessel, Chebyshev y elíptico (Cauer). Se discutió cómo cada tipo de filtro y método de diseño afecta la respuesta en frecuencia y la selectividad del filtro, adaptándose a las necesidades específicas de cada señal médica.

En el análisis del ECG, se observó que el filtro Butterworth IIR y el filtro FIR utilizando la ventana de Hamming y Blackman fueron efectivos para reducir el ruido y preservar las características importantes de la señal, como los complejos QRS. Similarmente, en el EEG, se encontró que el filtro Butterworth IIR es mejor al atenuar el ruido y mejorar la precisión en la detección de estados.

En el análisis del EEG, se encontró que tanto el filtro Butterworth IIR como el filtro FIR con ventana Bartlett fueron efectivos para reducir el ruido y mejorar la precisión en la detección de estados como la meditación y la concentración. Estos filtros permitieron una mejor identificación de las ondas cerebrales específicas, como las ondas alfa y beta, al tiempo que minimizaban la interferencia de frecuencias no deseadas.

En cuanto al EMG, se determinó que el filtro Butterworth IIR y el filtro FIR utilizando la ventana Hamming proporcionaron una mejora significativa en la detección de la actividad muscular, reduciendo el ruido y manteniendo la integridad de la señal muscular.

En resumen, el estudio demostró que la selección adecuada de filtros digitales FIR e IIR es crucial para mejorar la calidad de las mediciones en señales médicas como ECG, EEG y EMG, proporcionando una base sólida para futuros análisis y diagnósticos. Los resultados resaltan la importancia de considerar las características específicas de cada señal al diseñar y aplicar filtros digitales en el procesamiento de señales médicas.

<a id = "Bibliografía"></a>
<h2 style = "text-align: center;">Bibliografía</h2>

[1]	S. K. Mukhopadhyay y S. Krishnan, «A singular spectrum analysis-based model-free electrocardiogram denoising technique», Comput. Methods Programs Biomed., vol. 188, p. 105304, may 2020, doi: 10.1016/j.cmpb.2019.105304.

[2]	R. Thukral, A. Kumar, A. S. Arora, y Gulshan, «Effect of Different Thresholding Techniques for Denoising of EMG Signals by using Different Wavelets», en 2019 2nd International Conference on Intelligent Communication and Computational Techniques (ICCT), Jaipur, India: IEEE, sep. 2019, pp. 161-165. doi: 10.1109/ICCT46177.2019.8969036.

[3]	A. Ali y D. P. Subha, «Total Variation Denoising techniques for artifact removal from EEG signals», en 2021 International Conference on Artificial Intelligence and Smart Systems (ICAIS), Coimbatore, India: IEEE, mar. 2021, pp. 1594-1598. doi: 10.1109/ICAIS50930.2021.9396017.

[4]	J. G. Proakis, D. G. Manolakis, y J. G. Proakis, Digital signal processing: principles, algorithms, and applications, 2nd ed. New York : Toronto : New York: Macmillan ; Maxwell Macmillan Canada ; Maxwell Macmillan International, 1992.

[5]	«FIR Filter - an overview | ScienceDirect Topics». Accedido: 3 de mayo de 2024. [En línea]. Disponible en: https://www.sciencedirect.com/topics/engineering/fir-filter

[6]	J.-P. Caceres, «Análisis Espectral 1: Transformada Corta de Fourier y Ventanas».

[7]	«IIR Filter - an overview | ScienceDirect Topics». Accedido: 3 de mayo de 2024. [En línea]. Disponible en: https://www.sciencedirect.com/topics/engineering/iir-filter

[8]	«Bessel Filters - NI», https://www.ni.com. Accedido: 3 de mayo de 2024. [En línea]. Disponible en: https://www.ni.com/docs


[9]	«Butterworth Filters - NI», https://www.ni.com. Accedido: 3 de mayo de 2024. [En línea]. Disponible en: https://www.ni.com/docs

[10]	«Chebyshev Filters - NI», https://www.ni.com. Accedido: 3 de mayo de 2024. [En línea]. Disponible en: https://www.ni.com/docs

[11]	B. Salsekar y A. Wadhwani, «Filtering of ECG signal using butterworth filter and its feature extraction», Int. J. Eng. Sci. Technol., vol. 4, 2012.

[12]	S. Basu y S. Mamud, «Comparative Study on the Effect of Order and Cut off Frequency of Butterworth Low Pass Filter for Removal of Noise in ECG Signal», en 2020 IEEE 1st International Conference for Convergence in Engineering (ICCE), 2020, pp. 156-160. doi: 10.1109/ICCE50343.2020.9290646.

[13]	V. Rasel, A. Uma, y P. Kalpana, «Design of window based FIR filter for electrocardiogram noise removal», Int. J. Nonlinear Anal. Appl., vol. 12, n.o Special Issue, pp. 1519-1528, 2021.

[14]	S. Shama, A. Kumar, y Y. Kumar, «Hamming filter design for ECG signal detection and processing using co-simulation», en 2017 International Conference on Computing, Communication and Automation (ICCCA), IEEE, 2017, pp. 1029-1034.

[15] “Normal ECG responses during and postexercise,” Human Kinetics, https://us.humankinetics.com/blogs/excerpt/normal-ecg-responses-during-and-postexercise (accessed May 4, 2024). 

[16]	M. K. Hasan, R. Z. Rusho, T. M. Hossain, T. K. Ghosh, y M. Ahmad, «Design and simulation of cost effective wireless EEG acquisition system for patient monitoring», en 2014 International Conference on Informatics, Electronics & Vision (ICIEV), IEEE, 2014, pp. 1-5.

[17]	C. Covantes-Osuna, O. Paredes, H. Vélez-Pérez, y R. Romo-Vázquez, «Window Functions Analysis in Filters for EEG Movement Intention Signals», en Latin American Conference on Biomedical Engineering, Springer, 2019, pp. 182-190.

[18]«BITalino (r)evolution Lab Guide».

[19]	H. Wang, B. Bardizbanian, Z. Zhu, H. Wang, C. Dai, y E. A. Clancy, «Evaluation of generic EMG-Torque models across two Upper-Limb joints», J. Electromyogr. Kinesiol., vol. 75, p. 102864, abr. 2024, doi: 10.1016/j.jelekin.2024.102864.

[20] S. Basu and S. Mamud, “Comparative Study on the Effect of Order and Cut off Frequency of Butterworth Low Pass Filter for Removal of Noise in ECG Signal,” in 2020 IEEE 1st International Conference for Convergence in Engineering (ICCE), 2020, pp. 156–160. doi: 10.1109/ICCE50343.2020.9290646.

[21] N. Nazmi et al., “A review of classification techniques of EMG signals during isotonic and isometric contractions,” Sensors, vol. 16, no. 8, p. 1304, Aug. 2016. doi:10.3390/s16081304 


