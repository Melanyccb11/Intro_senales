<h1 style="text-align: center;">Laboratorio 6: Filtrado de Se√±ales Biol√≥gicas</h1>

</h3>Nombre de los Integrantes y c√≥digo:

1. Melany Cama Bahamonde 72128361
2. Alessandra Valle Montoya  71098563
3. Catherine Boggio Vidal 71329106
4. Juan Jose Sandoval Barrantes 74145560
</p>

<h2 style="text-align: center;">Tabla de Contenidos</h2>

1. [Objetivos](#objetivo)
2. [Introducci√≥n](#intro)
3. [Materiales y equipos](#matereiales)
4. [Metodolog√≠a](#metodo)
5. [Archivo de los datos de la se√±al ploteada](#archivosenal)
6. [Ploteo de la se√±al en Python](#python)
7. [Resumen y Discusi√≥n](#explic)
8. [Bibliograf√≠a](#Bibliograf√≠a)

<a id = "objetivo" style></a>
<h2 style = "text-align: center;">Objetivos</h2>
- Dise√±ar Filtros Digitales<br />
- Filtrar las Se√±ales de ECG, EMG, EGG en diferentes Estados Fisiol√≥gicos<br />
- Analizar los resultados obtenidos de las filtraciones.<br />


<a id = "intro" style></a>
<h2 style = "text-align: center;">Introducci√≥n</h2>

En la adquisici√≥n de se√±ales m√©dicas, la precisi√≥n y la eficiencia son aspectos relevantes para extraer informaci√≥n de las se√±ales biol√≥gicas. En este contexto, el dise√±o de filtros digitales se convierte en una herramienta fundamental para mejorar la calidad de las mediciones, eliminar ruidos no deseados y resaltar caracter√≠sticas espec√≠ficas de inter√©s en se√±ales como el electrocardiograma (ECG) [1] , el electromiograma (EMG) [2] y el electroencefalograma (EEG) [3]. Por ello, existen diferentes filtros que se encargan de eliminar los ruidos obtenidos a la hora de adquirir las se√±ales, en este laboratorio se har√° uso de los siguientes filtros:

### Filtros FIR (Respuesta al Impulso Finita):

Es un tipo de filtro digital que se caracteriza por tener una respuesta al impulso (la respuesta del filtro a una entrada de impulso unitario) que es de duraci√≥n finita, porque se asienta a cero en un tiempo finito.Este tipo de filtros tiene la propiedad de ser siempre estables, lo que los hace muy √∫tiles en diversas aplicaciones de procesamiento de se√±ales. Los filtros FIR pueden ser dise√±ados para tener una respuesta de fase lineal, lo que significa que todas las frecuencias en la banda de paso del filtro ser√°n desplazadas en el tiempo (o retrasadas) por la misma cantidad.
La ecuaci√≥n general para un filtro FIR de orden N es:

 </p>
<p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ecuaci%C3%B3n%20FIR.png">
<h5 align="center">
  <i>Figura 1. Ecuaci√≥n general para un filtro FIR de orden N </i></div>
<br /> </p>
 <div align="center"> <i>Donde:</i></div>
<p>
 y[n]: salida del filtro<br />
h[k]: coeficientes del filtro<br />
x[n-k]: son las entradas al filtro<br />
</i></div>
</h5>

Los coeficientes h[k] definen la respuesta al impulso del filtro y determinan las propiedades de frecuencia del filtro. Estos coeficientes pueden ser calculados utilizando varias t√©cnicas de dise√±o de filtros, como el m√©todo de ventanas, el m√©todo de frecuencia de muestreo, entre otros [4], [5].

 </p>
<p align="center">
 <img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/FIR%20IMAGE.jpg">
<h5 align="center">
  <i>Figura 2. Diagrama de bloques de un filtro de respuesta finita al impulso (FIR) que utiliza tres retardos y coeficientes ajustables ùê¥0, ùê¥1, ùê¥2, etc [5].</i></div>

####  M√©todo de ventanas:

1. Rectangular: Es la ventana m√°s simple y consiste en tomar un segmento de la se√±al y considerarlo tal cual, sin aplicar ninguna ponderaci√≥n. Tiene la mejor resoluci√≥n en frecuencia porque el ancho del l√≥bulo principal es el m√°s estrecho, permitiendo detectar frecuencias cercanas entre s√≠. Sin embargo, produce el mayor nivel de l√≥bulos secundarios, que resulta en un considerable rizado en el dominio de la frecuencia. Esto puede causar problemas como el aliasing cuando se utiliza en aplicaciones sensibles a las frecuencias no deseadas [4].
2. Hamming: Posee un l√≥bulo principal de ancho similar al de la ventana de Hanning que equilibra la resoluci√≥n en frecuencia con la supresi√≥n de la fuga espectral. La ventana minimiza efectos de borde al aproximarse a cero en los extremos y aunque sus l√≥bulos laterales son propensos al aliasing, presenta una mejor atenuaci√≥n del primer l√≥bulo lateral y una variaci√≥n m√°s uniforme en la amplitud de los l√≥bulos laterales, lo que es ventajoso para ciertas aplicaciones de an√°lisis espectral [6].
3. Hanning: Con una atenuaci√≥n del primer l√≥bulo de -31 dB y un decaimiento de los l√≥bulos laterales a una tasa de 18 dB por octava, la ventana de Hann ofrece una supresi√≥n m√°s efectiva de las frecuencias no deseadas en comparaci√≥n con la ventana rectangular, siendo ideal para aplicaciones donde la calidad espectral es prioritaria [6], [7].
4. Blackman: Ofrece una excelente atenuaci√≥n de los l√≥bulos secundarios, mucho mejor que las ventanas Hanning y Hamming, pero a expensas de un l√≥bulo principal m√°s ancho. Esto la hace menos ideal para detectar frecuencias cercanas entre s√≠, pero excelente para aplicaciones donde la supresi√≥n de los l√≥bulos secundarios es cr√≠tica.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ventanas%20fir.png"/>
<div align="center"> 
 <h5 align="center">
 <i>Figura 3. Comparaci√≥n de ventanas creadas para aplicarlas en filtros FIR [4].</i></div>
<p>
 
</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/tipos%20de%20ventana%20y%20anchura%20FIR.png"> 
<h5 align="center">
  <i>Figura 4. Caracter√≠sticas en el dominio de frecuencia de las ventanas [4].</i></div>
<p>


### Filtros IIR (Respuesta al Impulso Infinita): 

Filtro recursivo que calcula su salida utilizando tanto las entradas actuales como las anteriores y las salidas previas. Este tipo de filtro incorpora un mecanismo de retroalimentaci√≥n debido al uso de valores anteriores de la salida en su estructura. El dise√±o del filtro IIR implica determinar la funci√≥n de transferencia de pulso que cumpla con los criterios especificados para el filtro. Este dise√±o se puede realizar desarrollando primero un prototipo anal√≥gico y luego transform√°ndolo a una funci√≥n de transferencia de pulso, o dise√±ando directamente en el dominio digital [4], [7].

 </p>
<p align="center">
 <img width="500" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/IIR%20FILTER%20IMAGE.gif">
<h5 align="center">
  <i>Figura 5. Arquitectura de los filtros IIR [7].</i></div>

#### Tipos de filtro:

1. Bessel: Se usan para reducir la distorsi√≥n de fase no lineal en filtros IIR. Tienen una respuesta m√°ximamente plana en magnitud y fase, lo que significa una atenuaci√≥n uniforme en todas las frecuencias y una fase casi lineal en la banda de paso. Sin embargo, necesitan filtros de alto orden, lo que limita su uso. Son preferidos cuando se requiere una atenuaci√≥n uniforme y una transici√≥n suave entre la banda de paso y la de parada [8].
2. Butterworth: tienen una respuesta suave en todas las frecuencias y disminuyen de manera constante desde las frecuencias de corte. Son "maximally flat", con una respuesta ideal de unidad en la banda de paso y cero en la banda de parada. Aunque su transici√≥n entre la banda de paso y la banda de parada es lenta, ofrecen una respuesta de frecuencia suave y constante. La empinada transici√≥n aumenta con el orden del filtro, lo que permite aproximarse a la respuesta ideal del filtro paso bajo [9] .
3. Chebyshev: Minimiza el error m√°ximo en la banda de paso al permitir ondulaciones equirr√≠tmicas en esta regi√≥n. Tienen una respuesta en magnitud mon√≥tonamente decreciente en la banda de parada y una pendiente de atenuaci√≥n m√°s pronunciada que los filtros de Butterworth. La frecuencia de corte para los filtros de Chebyshev se define como el final de la banda de paso, donde la respuesta est√° 1 dB por debajo de su nivel m√°ximo y decrece mon√≥tonamente m√°s all√° de este punto [10].
4. El√≠ptica (Cauer): La ventana el√≠ptica se utiliza para dise√±ar filtros con una respuesta en frecuencia √≥ptima en t√©rminos de selectividad y ancho de banda de transici√≥n, a costa de tener ondulaciones tanto en la banda de paso como en la banda de parada. Es ideal para aplicaciones donde se requiere un alto grado de selectividad y una r√°pida transici√≥n entre la banda de paso y la banda de parada, como en filtros de alta frecuencia y sistemas de sonar.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/iir%20windows.png" align="center" width="660" height="500"/>
<div align="center">
 <h5 align="center">
 <i>Figura 6. Filtros IIR [X].</i></div>
<p>

  

<a id = "matereiales"></a>  
<h2 style = "text-align: center;">Materiales y equipos</h2>

<div align="center">

|   **Dispositivo**   | **Descripci√≥n** |  **Imagen**  |
|:-------------------:|:---------------:|:------------:|
|      laptop      | Una laptop equipada con Python, un lenguaje de programaci√≥n vers√°til y poderoso, es ideal para realizar tareas de programaci√≥n y an√°lisis de datos en entornos de laboratorio. |<img width="200" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/68af906e-92c2-4096-ab4c-06e60cba53f1.jpg">|

</div>


<a id = "metodo" style></a>
<h2 style = "text-align: center;">Metodolod√≠a</h2>

### Metodolog√≠a General
</p>

1. Preparaci√≥n y Entendimiento de Datos:
   - Revisar los datasets disponibles para cada ejercicio para entender las caracter√≠sticas y el formato de los datos.
   - Identificar las se√±ales crudas que ser√°n procesadas en cada laboratorio.
2. Dise√±o de Filtros:
   - Definir las caracter√≠sticas y especificaciones t√©cnicas de cada filtro requerido para el ECG, EMG y EEG.
   - Utilizar herramientas como Python y librer√≠as espec√≠ficas para el dise√±o y la implementaci√≥n de filtros FIR e IIR.
3. Aplicaci√≥n de Filtros y An√°lisis de Resultados:
   - Aplicar los filtros dise√±ados a las se√±ales crudas y generar se√±ales filtradas.
   - Visualizar y comparar las se√±ales antes y despu√©s del filtrado para evaluar la efectividad de cada filtro.
4. Documentaci√≥n y Reporte:
   - Preparar informes detallados con resultados, visualizaciones y discusi√≥n sobre la efectividad de los filtros.
   - Organizar los c√≥digos fuente y resultados para la subida a la plataforma de GitHub.

</p>

### Metodolog√≠a Espec√≠fica - Laboratorios 
</p>

#### ECG:
1. Selecci√≥n de Filtro IIR:
   - Dise√±ar un filtro IIR con opciones como Bessel, Butterworth, Chebyshev o El√≠ptico, para filtrar en frecuencias altas.
2. Selecci√≥n de Filtro FIR:
   - Elegir dos m√©todos de ventana (Hanning, Hamming, Bartlett, rectangular o Blackman) para un filtro FIR.
   - Dise√±ar el filtro FIR con una frecuencia de corte adecuada para el contexto del ECG.
3. Visualizaci√≥n y Reporte:
   - Crear gr√°ficos comparativos para cada estado ('Basal', 'Respiraci√≥n', 'Post-ejercicio') con la se√±al cruda, filtrada con IIR y filtrada con FIR.

#### EMG:
1. Selecci√≥n de Filtro IIR:
   - Elegir un tipo de filtro IIR para eliminar frecuencias altas que corresponden a ruido el√©ctrico y artefactos.
2. Selecci√≥n de Filtro FIR:
   - Dise√±ar un filtro FIR utilizando ventanas como Hamming o Blackman, enfocado en aislar la banda de frecuencia que corresponde a la actividad muscular.
   - Especificaciones: Fc = 50 Hz, paso banda bajo.
3. Visualizaci√≥n y Reporte:
   - Crear gr√°ficos comparativos con los campos de actividad ('Descanso', 'Contracci√≥n leve', 'Contracci√≥n fuerte').

#### EEG:
1. Selecci√≥n de Filtro IIR:
   - Implementar un filtro IIR para suprimir interferencias de alta frecuencia.
2. Selecci√≥n de Filtro FIR:
   - Utilizar m√©todos de ventana para dise√±ar un filtro FIR que extraiga bandas de frecuencia espec√≠ficas (alfa, beta).
   - Especificaciones: Fc = 12 Hz, paso banda para ondas espec√≠ficas.
3. Visualizaci√≥n y Reporte:
   - Generar gr√°ficos comparativos con estados de 'Vigilia', 'Abrir y cerrar ojos con un patr√≥n', 'Resolviendo problemas matem√°ticos'.
    
</p>

<a id = "archivosenal"></a>
<h2 style = "text-align: center;">Archivos de los datos de la se√±al ploteada</h2>
</h5>

#### ECG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/NormalBreath30s.txt)</p>
2. [Registro 2 - Bitalino: Inhalando/Manteniendo/Exhalando por 5s](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/InHoldEx5s.txt)</p>
3. [Registro 3 - Bitalino: Despu√©s del burpee](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/ReposandoBurpee30s.txt)</p>
#### EEG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_PrimeroOsjoscerrados.txt)</p>
2. [Registro 2 - Bitalino: Abriendo/Cerrando ojos](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_2_5s.txt)</p>
3. [Registro 3 - Bitalino: Resolviendo ejercicios](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/ejmate.txt)</p>
#### EMG
1. [Registro 1 - Bitalino: Reposo/ontracci√≥n leve/ontracci√≥n fuerte](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/3.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EMG/text_EMG.txt)</p>

### Archivos python 

1. [C√≥digo principal - IIR y FIR ](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Filtros_lab6.ipynb)</p>


<a id = "python"></a>
<h2 style = "text-align: center;">Ploteo de la se√±al en Python</h2>
</p>

En el an√°lisis de se√±ales biol√≥gicas, la elecci√≥n de filtros es crucial para resaltar caracter√≠sticas relevantes y eliminar ruido no deseado. En este estudio, se explorar√°n filtros IIR (Infinite Impulse Response) y FIR (Finite Impulse Response) con diferentes frecuencias de corte, adapt√°ndose a los par√°metros espec√≠ficos de cada se√±al biol√≥gica evaluada. Se examinar√° c√≥mo estos filtros influyen en la interpretaci√≥n de las se√±ales filtradas, considerando aspectos como la preservaci√≥n de caracter√≠sticas importantes y la atenuaci√≥n del ruido. Al concluir, se determinar√° qu√© tipo de filtro, ya sea IIR o FIR, se adapta mejor a las necesidades particulares de procesamiento de la se√±al biol√≥gica en cuesti√≥n, proporcionando una base s√≥lida para futuros an√°lisis y diagn√≥sticos.
</p>
Comenzamos realizando la FFT de la se√±al original que nos permite analizar el dominio de la frecuencia en el dominio del tiempo. Esta informaci√≥n es esencial para el dise√±o y la implementaci√≥n de t√©cnicas de filtrado eficaces, ya que nos proporciona una base s√≥lida para identificar y atenuar selectivamente las componentes de frecuencia no deseadas.</p>


## Para las se√±ales de ECG 
Se realiza la elecci√≥n de los filtros FIR e IIR, en el caso de del ECG, se eligen:
1. Selecci√≥n de Filtro IIR:
   - Para mitigar el ruido presente en las se√±ales adquiridas de electrocardiograma (ECG) en el laboratorio 4, hemos empleado el filtro Butterworth. Este tipo de filtro ha demostrado ser altamente efectivo en la eliminaci√≥n del ruido de las se√±ales de ECG afectadas [11]. Al observar la gr√°fica, podemos apreciar una notable reducci√≥n del ruido en comparaci√≥n con la se√±al original. Este resultado se atribuye principalmente a la elecci√≥n de la frecuencia de corte y al orden del filtro [12]. En nuestro estudio, hemos dise√±ado un filtro con una frecuencia de corte de 50 Hz y un orden de 4. No obstante, al aplicar el filtro, hemos observado una disminuci√≥n en la amplitud de las ondas R y T. Este efecto se debe al orden del filtro seleccionado. Sin embargo, gracias a la frecuencia de corte, hemos notado una mejora significativa en la nitidez del complejo QRS [12].
2. Selecci√≥n de Filtro FIR:
   - Adem√°s, implementamos un filtro FIR utilizando la ventana de Hamming y Blackman, con una frecuencia de corte de 50 Hz y con un orden de 101 [14]. Esta ventana se caracteriza por tener l√≥bulos laterales cercanos a cero, lo que significa que reduce significativamente la fuga de energ√≠a de la se√±al fuera de la banda de inter√©s. Este enfoque ayuda a mejorar la selectividad del filtro y a minimizar la distorsi√≥n de la se√±al de inter√©s [14]. Sin embargo, al representar gr√°ficamente la se√±al filtrada, observamos un aumento en la amplitud dentro del intervalo ST, en comparaci√≥n con la se√±al original, y tambi√©n se detecta un retraso de la se√±al con respecto a la original. Este comportamiento puede ser atribuido al error y al retraso inherentes al filtro utilizado, a pesar de ello cumple con la funci√≥n de filtrar la se√±al. [14].

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 7. Filtros para la se√±al de ECG. [Elaboraci√≥n propia]</i></div>
<p>



### Reposo :
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT.jpg"> 
<h5 align="center">
  <i>Figura 8. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura 9: Se√±al obtenida en python: Actividad en reposo.[Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n[15]:
1. Picos agudos en la se√±al original: Estos picos se observan claramente alrededor de los 20.50 segundos y 21.50 segundos. Estos probablemente corresponden a los complejos QRS, que son indicativos de la actividad el√©ctrica del coraz√≥n asociada con la contracci√≥n de los ventr√≠culos. Son las caracter√≠sticas m√°s notables en una se√±al de EKG y representan un punto de an√°lisis crucial.
2. Respuesta de los filtros:
- FIR filtro Hamming: La se√±al filtrada con Hamming muestra una suavizaci√≥n de la se√±al pero sigue reflejando los picos, aunque con menos ruido y variaciones menores entre los picos.
- FIR filtro Blackman: Similar al filtro Hamming, este filtro tambi√©n suaviza la se√±al pero mantiene una amplitud considerable en los picos QRS, mostrando una buena preservaci√≥n de las caracter√≠sticas importantes del EKG.
- IIR filtro Butterworth: Este filtro muestra una respuesta m√°s variable. Mientras que filtra bastante ruido, tambi√©n parece alterar un poco m√°s la amplitud y la forma de los picos QRS, especialmente notable alrededor de los 21.50 segundos donde el pico parece m√°s distorsionado en comparaci√≥n con los filtros FIR.
  
La ventana de inter√©s m√°s significativa estar√≠a centrada alrededor de estos picos QRS, ya que son esenciales para analizar el ritmo card√≠aco y la actividad el√©ctrica del coraz√≥n. Estos segmentos, espec√≠ficamente alrededor de 20.50 y 21.50 segundos, ser√≠an los puntos focales para un an√°lisis m√°s detallado de la se√±al de reposo.

### Inhalando/Manteniendo/Exhalando por 5s
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT2.jpg"> 
<h5 align="center">
  <i>Figura 10. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_IN_HOLS_EX.jpg">
</p>
<h5 align="center">
  Figura 11: Se√±al obtenida en python: Inhalando/Manteniendo/Exhalando por 5s. [Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n[15]:

En la nueva gr√°fica, las ventanas de inter√©s pueden identificarse alrededor de los picos m√°s prominentes en la se√±al original, que son visibles cerca de los 20.50 segundos y 21.50 segundos. Estos picos, que probablemente representan los complejos QRS, son momentos clave en un EKG ya que indican la actividad el√©ctrica de los ventr√≠culos del coraz√≥n.

- FIR filtro Hamming y FIR filtro Blackman: Ambos filtros han suavizado la se√±al, pero a√∫n conservan las caracter√≠sticas de los picos, haciendo que estas caracter√≠sticas sean claramente visibles, aunque con una amplitud algo reducida. Estos filtros est√°n logrando una buena balance entre reducir el ruido y preservar la informaci√≥n importante de los picos QRS.
- IIR filtro Butterworth: Este filtro muestra una reducci√≥n significativa en el ruido de la se√±al y una preservaci√≥n adecuada de los picos, aunque con un efecto de suavizado m√°s pronunciado que podr√≠a afectar la nitidez de los picos QRS.

La ventana de inter√©s para un an√°lisis m√°s detallado ser√≠a entre 20.25 segundos y 21.75 segundos, abarcando ambos picos QRS y permitiendo evaluar la eficacia del filtro en preservar la integridad de estos importantes eventos card√≠acos mientras reduce el ruido circundante.

### Despu√©s del ejercicio f√≠sico
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 40 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_FFT3.jpg"> 
<h5 align="center">
  <i>Figura 12. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_POST-BURPEE.jpg">
</p>
<h5 align="center">
  Figura 13. Se√±al obtenida en python: Despu√©s del ejercicio f√≠sico. [Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n[15]:

En esta gr√°fica despu√©s de realizar un ejercicio f√≠sico, las ventanas de inter√©s son claramente visibles alrededor de los picos m√°s altos de la se√±al original, que se producen cerca de los 2.50 segundos y 3.25 segundos. Estos picos son indicativos de los complejos QRS, que son cruciales para analizar la actividad el√©ctrica del coraz√≥n, especialmente despu√©s del ejercicio.

- FIR filtro Hamming: Muestra una suavizaci√≥n significativa de la se√±al con menos ruido, pero a√∫n conserva la forma de los picos QRS, lo que es esencial para mantener la informaci√≥n diagn√≥stica relevante.
- FIR filtro Blackman: Similar al filtro Hamming, tambi√©n suaviza la se√±al mientras preserva los picos, aunque con una ligera distorsi√≥n en la forma y la amplitud de los picos.
- IIR filtro Butterworth: Este filtro muestra una respuesta m√°s suave con cierta distorsi√≥n en los picos QRS, lo que podr√≠a ser relevante al analizar c√≥mo afecta el ejercicio a la se√±al card√≠aca.

La ventana de inter√©s para el an√°lisis detallado en este caso se extender√≠a desde aproximadamente los 2.25 segundos hasta los 3.50 segundos, abarcando ambos picos QRS principales. Este rango incluye los eventos card√≠acos m√°s significativos en el periodo post-ejercicio, permitiendo una evaluaci√≥n efectiva de c√≥mo el ejercicio ha influido en la actividad el√©ctrica del coraz√≥n.

## Para las se√±ales de EEG 

Se realiza la elecci√≥n de los filtros FIR e IIR, en el caso de del EEG, se eligen:
1. Selecci√≥n de Filtro IIR:
   - Para las se√±ales en EEG, al igual que en ECG, elegimos para los filtros IIR el Butterworth de cuarto orden, ya que este es com√∫nmente utilizado para el procesamiento de se√±ales de EEG con el fin de filtrar y eliminar componentes no deseados . En las gr√°ficas podemos observar que las se√±ales se aten√∫an sin tener un delay, sin embargo hay un cambio en su amplitud[16]. 
2. Selecci√≥n de Filtro FIR:
   - En el caso de los filtros FIR se us√≥ la ventana Bartlett, la cual una de las propiedades que tiene es la de mitigar fugas espectrales y la varianza en el espectro obtenido. Es decir que el efecto que tiene esta ventana es la de una se√±al de EEG con una representaci√≥n m√°s precisa y una representaci√≥n m√°s constante en el tiempo para poder realizar un mejor an√°lisis de la se√±al [17].  

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 14. Filtros para la se√±al de EEG. [Elaboraci√≥n propia]</i></div>
<p>

### Reposo :

Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT1.jpg"> 
<h5 align="center">
  <i>Figura 15. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura 16. Se√±al obtenida en python: Actividad en reposo. [Elaboraci√≥n propia]
</h5>



#### Interpretaci√≥n:

Como podemos observar en las gr√°ficas que hemos obtenido en la parte de reposo el n√∫mero de picos por segundo es igual a 12 aproximadamente, lo que indica que el sujeto est√° en un estado de meditaci√≥n y relajaci√≥n [18].




### Abrir y cerrar los ojos  5s 

Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT2.jpg"> 
<h5 align="center">
  <i>Figura 17. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_ABR_CER_OJOS.jpg">
</p>
<h5 align="center">
  Figura 18. Se√±al obtenida en python: Abrir y cerrar los ojos  5s c/u.[Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n:

Por otro lado en la gr√°fica donde cierra y abre los ojos podemos ver una onda de mayor amplitud y duraci√≥n en el tiempo lo que puede indicar que es en el momento donde pas√≥ de cerrado a abierto[18]. 


### Resolviendo ejercicios matematicos 
Primero sacamos la DFT, en donde determinamos que una optima frecuencia de corte es 12 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_FFT3.jpg"> 
<h5 align="center">
  <i>Figura 19. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
<p>
</br>


</p>
<p align="center">
<img width="800" height="600"src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_MATE.jpg">
</p>
<h5 align="center">
  Figura 20. Se√±al obtenida en python: Resolviendo ejercicios matematicos. [Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n:

Por √∫ltimo tenemos que en el apartado donde se resuelven ejercicios, como se coment√≥ en la anterior entrega nuestra participante al realizarle la pregunta no supo qu√© decir al instante. Por lo que no realiz√≥ el ejercicio mental y por ello salen ondas betas en la gr√°fica [18].



## Para las se√±ales de EMG 

Primero sacamos la DFT, en donde determinamos que una √≥ptima frecuencia de corte es 50 Hz:
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_FFT.jpg"> 
<h5 align="center">
  <i>Figura 21. FFT de la se√±al [Elaboraci√≥n propia].</i></div>
 </h5>
<p>
</br>



Se realiza la elecci√≥n de los filtros FIR e IIR, en el caso de del ECG, se eligen:
1. Selecci√≥n de Filtro IIR:
   - El uso del filtro Butterworth logra una reducci√≥n efectiva del ruido en las se√±ales de EMG, proporcionando resultados comparables a los modelos m√°s complejos y espec√≠ficos del sujeto, pero con una implementaci√≥n m√°s sencilla y menos costosa [19]. Es por ese motivo que tambi√©n utilizamos este filtro en EMG y lo podemos comprobar con las gr√°ficas que obtuvimos tras aplicarlo.

2. Selecci√≥n de Filtro FIR:
   - El uso de filtros de ventana la ventana Hamming aten√∫a el ruido y mejora la calidad de la se√±al. Estos filtros reducen las fuentes de interferencia electromagn√©tica y artefactos de movimiento, mejorando as√≠ la precisi√≥n de las mediciones EMG al minimizar la contaminaci√≥n espectral de frecuencias no deseadas. Y es lo que podemos apreciar en las siguientes gr√°ficas [20].


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_FILTROS.jpg"> 
<h5 align="center">
  <i>Figura 22. Filtros para la se√±al de EMG.[Elaboraci√≥n propia]</i></div>
<p>


### Reposo :

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_REPOSO.jpg">
</p>
<h5 align="center">
  <i>Figura 23. Se√±al obtenida en python: Actividad en reposo. [Elaboraci√≥n propia]</i></div>
</h5>



#### Interpretaci√≥n [21]:

- En la gr√°fica para la se√±al EMG, parece que hay una secci√≥n claramente diferenciada donde se muestra una actividad considerablemente mayor comparada con el resto de la se√±al. Esta secci√≥n se caracteriza por un aumento en la amplitud y la variabilidad de la se√±al, y est√° ubicada entre aproximadamente 2 segundos y 8 segundos en el eje de tiempo.

- Esta ventana, que muestra una alta actividad muscular, probablemente es el segmento de inter√©s donde se esperar√≠a que los filtros IIR y FIR tengan un impacto significativo en el procesamiento de la se√±al para reducir ruido y otros artefactos, mientras se mantiene la informaci√≥n muscular esencial. Observando las l√≠neas de las se√±ales filtradas (IIR y FIR), parece que los filtros han sido aplicados a toda la se√±al, pero es en esta ventana donde su efecto ser√≠a m√°s crucial para evaluar, ya que es donde la se√±al es m√°s prominente y potencialmente m√°s susceptible al ruido y a las fluctuaciones no deseadas.


### Contracci√≥n leve

</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CON_LEVE.jpg">
</p>
<h5 align="center">
  Figura 24. Se√±al obtenida en python: Contracci√≥n leve. [Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n[21]:

- En esta nueva gr√°fica, al observar la actividad m√°s significativa, parece que la ventana de inter√©s, donde la se√±al muestra mayor variabilidad y amplitud, est√° comprendida aproximadamente entre los 13.6 segundos y los 15.0 segundos en el eje del tiempo.

- Dentro de este intervalo, se pueden notar picos m√°s altos y una mayor fluctuaci√≥n en la se√±al original (en azul), lo cual es t√≠pico en segmentos de actividad muscular activa o momentos de artefactos. La se√±al filtrada con el filtro IIR (en rosa) muestra una reducci√≥n notable en la variabilidad y mantiene una amplitud m√°s constante, lo que indica que el filtro ha suavizado eficazmente la se√±al. Por otro lado, la se√±al filtrada con el filtro FIR (en verde) tambi√©n muestra una forma m√°s suave comparada con la se√±al original, conservando un perfil que sigue de cerca las fluctuaciones de la se√±al original pero con una reducci√≥n en el ruido de alta frecuencia.

- Estos resultados sugieren que ambos filtros est√°n trabajando como se espera en esta ventana, reduciendo el ruido y suavizando la se√±al sin eliminar completamente la informaci√≥n subyacente de la actividad muscular. Esto ser√≠a el foco principal de an√°lisis para evaluar la efectividad del filtrado aplicado.

### Contracci√≥n fuerte
</p>
<p align="center">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CONT_FUERTE.jpg">
</p>
<h5 align="center">
  Figura 25. Se√±al obtenida en python: Contracci√≥n fuerte. [Elaboraci√≥n propia]
</h5>

#### Interpretaci√≥n[21]:

- En esta gr√°fica observamos varias secciones con diferentes niveles de actividad. La ventana de inter√©s parece ser entre los 16.5 segundos y 17.5 segundos en el eje del tiempo. Durante este intervalo, se aprecia un aumento significativo en la amplitud y variabilidad de la se√±al original (en azul), lo que indica una mayor actividad muscular en comparaci√≥n con las regiones antes y despu√©s de este intervalo.

- Las se√±ales filtradas con filtros IIR (en rosa) y FIR (en verde) muestran una reducci√≥n en la amplitud de las fluctuaciones y una se√±al m√°s suavizada, pero todav√≠a siguen los patrones generales de la se√±al original dentro de esta ventana. Esto indica que ambos filtros est√°n efectivamente atenuando el ruido y otros componentes de alta frecuencia, mientras preservan la forma de la se√±al muscular subyacente en este segmento.

<a id = "explic"></a>
<h2 style = "text-align: center;">Resumen y Discusi√≥n</h2>

El estudio realizado se enfoca en el dise√±o y la implementaci√≥n de filtros digitales FIR (Respuesta al Impulso Finita) e IIR (Respuesta al Impulso Infinita) para el procesamiento de se√±ales m√©dicas, espec√≠ficamente el electrocardiograma (ECG), el electromiograma (EMG) y el electroencefalograma (EEG). La precisi√≥n y la eficiencia en la extracci√≥n de informaci√≥n de estas se√±ales son aspectos fundamentales, y los filtros juegan un papel crucial en mejorar la calidad de las mediciones, eliminando ruidos no deseados y resaltando caracter√≠sticas espec√≠ficas[12-21].

En el laboratorio, se exploraron diferentes tipos de filtros FIR, como el m√©todo de ventanas, que incluye opciones como rectangular, Hamming, Hanning y Blackman, y filtros IIR, como Butterworth, Bessel, Chebyshev y el√≠ptico (Cauer). Se discuti√≥ c√≥mo cada tipo de filtro y m√©todo de dise√±o afecta la respuesta en frecuencia y la selectividad del filtro, adapt√°ndose a las necesidades espec√≠ficas de cada se√±al m√©dica.

En el an√°lisis del ECG, se observ√≥ que el filtro Butterworth IIR y el filtro FIR utilizando la ventana de Hamming y Blackman fueron efectivos para reducir el ruido y preservar las caracter√≠sticas importantes de la se√±al, como los complejos QRS. Similarmente, en el EEG, se encontr√≥ que el filtro Butterworth IIR es mejor al atenuar el ruido y mejorar la precisi√≥n en la detecci√≥n de estados.

En el an√°lisis del EEG, se encontr√≥ que tanto el filtro Butterworth IIR como el filtro FIR con ventana Bartlett fueron efectivos para reducir el ruido y mejorar la precisi√≥n en la detecci√≥n de estados como la meditaci√≥n y la concentraci√≥n. Estos filtros permitieron una mejor identificaci√≥n de las ondas cerebrales espec√≠ficas, como las ondas alfa y beta, al tiempo que minimizaban la interferencia de frecuencias no deseadas.

En cuanto al EMG, se determin√≥ que el filtro Butterworth IIR y el filtro FIR utilizando la ventana Hamming proporcionaron una mejora significativa en la detecci√≥n de la actividad muscular, reduciendo el ruido y manteniendo la integridad de la se√±al muscular.

En resumen, el estudio demostr√≥ que la selecci√≥n adecuada de filtros digitales FIR e IIR es crucial para mejorar la calidad de las mediciones en se√±ales m√©dicas como ECG, EEG y EMG, proporcionando una base s√≥lida para futuros an√°lisis y diagn√≥sticos. Los resultados resaltan la importancia de considerar las caracter√≠sticas espec√≠ficas de cada se√±al al dise√±ar y aplicar filtros digitales en el procesamiento de se√±ales m√©dicas.

<a id = "Bibliograf√≠a"></a>
<h2 style = "text-align: center;">Bibliograf√≠a</h2>

[1]	S. K. Mukhopadhyay y S. Krishnan, ¬´A singular spectrum analysis-based model-free electrocardiogram denoising technique¬ª, Comput. Methods Programs Biomed., vol. 188, p. 105304, may 2020, doi: 10.1016/j.cmpb.2019.105304.

[2]	R. Thukral, A. Kumar, A. S. Arora, y Gulshan, ¬´Effect of Different Thresholding Techniques for Denoising of EMG Signals by using Different Wavelets¬ª, en 2019 2nd International Conference on Intelligent Communication and Computational Techniques (ICCT), Jaipur, India: IEEE, sep. 2019, pp. 161-165. doi: 10.1109/ICCT46177.2019.8969036.

[3]	A. Ali y D. P. Subha, ¬´Total Variation Denoising techniques for artifact removal from EEG signals¬ª, en 2021 International Conference on Artificial Intelligence and Smart Systems (ICAIS), Coimbatore, India: IEEE, mar. 2021, pp. 1594-1598. doi: 10.1109/ICAIS50930.2021.9396017.

[4]	J. G. Proakis, D. G. Manolakis, y J. G. Proakis, Digital signal processing: principles, algorithms, and applications, 2nd ed. New York‚ÄØ: Toronto‚ÄØ: New York: Macmillan‚ÄØ; Maxwell Macmillan Canada‚ÄØ; Maxwell Macmillan International, 1992.

[5]	¬´FIR Filter - an overview | ScienceDirect Topics¬ª. Accedido: 3 de mayo de 2024. [En l√≠nea]. Disponible en: https://www.sciencedirect.com/topics/engineering/fir-filter

[6]	J.-P. Caceres, ¬´An√°lisis Espectral 1: Transformada Corta de Fourier y Ventanas¬ª.

[7]	¬´IIR Filter - an overview | ScienceDirect Topics¬ª. Accedido: 3 de mayo de 2024. [En l√≠nea]. Disponible en: https://www.sciencedirect.com/topics/engineering/iir-filter

[8]	¬´Bessel Filters - NI¬ª, https://www.ni.com. Accedido: 3 de mayo de 2024. [En l√≠nea]. Disponible en: https://www.ni.com/docs


[9]	¬´Butterworth Filters - NI¬ª, https://www.ni.com. Accedido: 3 de mayo de 2024. [En l√≠nea]. Disponible en: https://www.ni.com/docs

[10]	¬´Chebyshev Filters - NI¬ª, https://www.ni.com. Accedido: 3 de mayo de 2024. [En l√≠nea]. Disponible en: https://www.ni.com/docs

[11]	B. Salsekar y A. Wadhwani, ¬´Filtering of ECG signal using butterworth filter and its feature extraction¬ª, Int. J. Eng. Sci. Technol., vol. 4, 2012.

[12]	S. Basu y S. Mamud, ¬´Comparative Study on the Effect of Order and Cut off Frequency of Butterworth Low Pass Filter for Removal of Noise in ECG Signal¬ª, en 2020 IEEE 1st International Conference for Convergence in Engineering (ICCE), 2020, pp. 156-160. doi: 10.1109/ICCE50343.2020.9290646.

[13]	V. Rasel, A. Uma, y P. Kalpana, ¬´Design of window based FIR filter for electrocardiogram noise removal¬ª, Int. J. Nonlinear Anal. Appl., vol. 12, n.o Special Issue, pp. 1519-1528, 2021.

[14]	S. Shama, A. Kumar, y Y. Kumar, ¬´Hamming filter design for ECG signal detection and processing using co-simulation¬ª, en 2017 International Conference on Computing, Communication and Automation (ICCCA), IEEE, 2017, pp. 1029-1034.

[15] ‚ÄúNormal ECG responses during and postexercise,‚Äù Human Kinetics, https://us.humankinetics.com/blogs/excerpt/normal-ecg-responses-during-and-postexercise (accessed May 4, 2024). 

[16]	M. K. Hasan, R. Z. Rusho, T. M. Hossain, T. K. Ghosh, y M. Ahmad, ¬´Design and simulation of cost effective wireless EEG acquisition system for patient monitoring¬ª, en 2014 International Conference on Informatics, Electronics & Vision (ICIEV), IEEE, 2014, pp. 1-5.

[17]	C. Covantes-Osuna, O. Paredes, H. V√©lez-P√©rez, y R. Romo-V√°zquez, ¬´Window Functions Analysis in Filters for EEG Movement Intention Signals¬ª, en Latin American Conference on Biomedical Engineering, Springer, 2019, pp. 182-190.

[18]¬´BITalino (r)evolution Lab Guide¬ª.

[19]	H. Wang, B. Bardizbanian, Z. Zhu, H. Wang, C. Dai, y E. A. Clancy, ¬´Evaluation of generic EMG-Torque models across two Upper-Limb joints¬ª, J. Electromyogr. Kinesiol., vol. 75, p. 102864, abr. 2024, doi: 10.1016/j.jelekin.2024.102864.

[20] S. Basu and S. Mamud, ‚ÄúComparative Study on the Effect of Order and Cut off Frequency of Butterworth Low Pass Filter for Removal of Noise in ECG Signal,‚Äù in 2020 IEEE 1st International Conference for Convergence in Engineering (ICCE), 2020, pp. 156‚Äì160. doi: 10.1109/ICCE50343.2020.9290646.

[21] N. Nazmi et al., ‚ÄúA review of classification techniques of EMG signals during isotonic and isometric contractions,‚Äù Sensors, vol. 16, no. 8, p. 1304, Aug. 2016. doi:10.3390/s16081304 


