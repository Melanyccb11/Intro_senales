<h1 style="text-align: center;">Laboratorio 6: Filtrado de Se帽ales Biol贸gicas</h1>

</h3>Nombre de los Integrantes y c贸digo:

1. Melany Cama Bahamonde 72128361
2. Alessandra Valle Montoya  71098563
3. Catherine Boggio Vidal 71329106
4. Juan Jose Sandoval Barrantes 74145560
</p>

<h2 style="text-align: center;">Tabla de Contenidos</h2>

1. [Objetivos](#objetivo)
2. [Introducci贸n](#intro)
3. [Materiales y equipos](#matereiales)
4. [Metodolog铆a](#metodo)
5. [Archivo de los datos de la se帽al ploteada](#archivosenal)
6. [Ploteo de la se帽al en Python](#python)
7. [Resumen y Discusi贸n](#explic)
8. [Bibliograf铆a](#Bibliograf铆a)

<a id = "objetivo" style></a>
<h2 style = "text-align: center;">Objetivos</h2>
- Dise帽ar Filtros Digitales<br />
- Filtrar las Se帽ales de ECG, EMG, EGG en diferentes Estados Fisiol贸gicos<br />
- Analizar los resultados obtenidos de las filtraciones.<br />


<a id = "intro" style></a>
<h2 style = "text-align: center;">Introducci贸n</h2>

En la adquisici贸n de se帽ales m茅dicas, la precisi贸n y la eficiencia son aspectos relevantes para extraer informaci贸n de las se帽ales biol贸gicas. En este contexto, el dise帽o de filtros digitales se convierte en una herramienta fundamental para mejorar la calidad de las mediciones, eliminar ruidos no deseados y resaltar caracter铆sticas espec铆ficas de inter茅s en se帽ales como el electrocardiograma (ECG) [1] , el electromiograma (EMG) [2] y el electroencefalograma (EEG) [3]. Por ello, existen diferentes filtros que se encargan de eliminar los ruidos obtenidos a la hora de adquirir las se帽ales, en este laboratorio se har谩 uso de los siguientes filtros:

### Filtros FIR (Respuesta al Impulso Finita):

Es un tipo de filtro digital que se caracteriza por tener una respuesta al impulso (la respuesta del filtro a una entrada de impulso unitario) que es de duraci贸n finita, porque se asienta a cero en un tiempo finito.Este tipo de filtros tiene la propiedad de ser siempre estables, lo que los hace muy 煤tiles en diversas aplicaciones de procesamiento de se帽ales. Los filtros FIR pueden ser dise帽ados para tener una respuesta de fase lineal, lo que significa que todas las frecuencias en la banda de paso del filtro ser谩n desplazadas en el tiempo (o retrasadas) por la misma cantidad.
La ecuaci贸n general para un filtro FIR de orden N es:

 </p>
<p align="center">
 <img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ecuaci%C3%B3n%20FIR.png">
<h5 align="center">
  <i>Figura 1.Ecuaci贸n general para un filtro FIR de orden N </i></div>

 <div align="center"> <i>Donde:</i></div>
<p>
 y[n]: salida del filtro<br />
h[k]: coeficientes del filtro<br />
x[n-k]: son las entradas al filtro<br />
</i></div>
</h5>

Los coeficientes h[k] definen la respuesta al impulso del filtro y determinan las propiedades de frecuencia del filtro. Estos coeficientes pueden ser calculados utilizando varias t茅cnicas de dise帽o de filtros, como el m茅todo de ventanas, el m茅todo de frecuencia de muestreo, entre otros [4], [5].

 </p>
<p align="center">
 <img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/FIR%20IMAGE.jpg">
<h5 align="center">
  <i>Figura 2.Diagrama de bloques de un filtro de respuesta finita al impulso (FIR) que utiliza tres retardos y coeficientes ajustables 0, 1, 2, etc [5].</i></div>

####  M茅todo de ventanas:

1. Rectangular: Es la ventana m谩s simple y consiste en tomar un segmento de la se帽al y considerarlo tal cual, sin aplicar ninguna ponderaci贸n. Tiene la mejor resoluci贸n en frecuencia porque el ancho del l贸bulo principal es el m谩s estrecho, permitiendo detectar frecuencias cercanas entre s铆. Sin embargo, produce el mayor nivel de l贸bulos secundarios, que resulta en un considerable rizado en el dominio de la frecuencia. Esto puede causar problemas como el aliasing cuando se utiliza en aplicaciones sensibles a las frecuencias no deseadas [4].
2. Hamming: Posee un l贸bulo principal de ancho similar al de la ventana de Hanning que equilibra la resoluci贸n en frecuencia con la supresi贸n de la fuga espectral. La ventana minimiza efectos de borde al aproximarse a cero en los extremos y aunque sus l贸bulos laterales son propensos al aliasing, presenta una mejor atenuaci贸n del primer l贸bulo lateral y una variaci贸n m谩s uniforme en la amplitud de los l贸bulos laterales, lo que es ventajoso para ciertas aplicaciones de an谩lisis espectral [6].
3. Hanning: Con una atenuaci贸n del primer l贸bulo de -31 dB y un decaimiento de los l贸bulos laterales a una tasa de 18 dB por octava, la ventana de Hann ofrece una supresi贸n m谩s efectiva de las frecuencias no deseadas en comparaci贸n con la ventana rectangular, siendo ideal para aplicaciones donde la calidad espectral es prioritaria [6], [7].
4. Blackman: Ofrece una excelente atenuaci贸n de los l贸bulos secundarios, mucho mejor que las ventanas Hanning y Hamming, pero a expensas de un l贸bulo principal m谩s ancho. Esto la hace menos ideal para detectar frecuencias cercanas entre s铆, pero excelente para aplicaciones donde la supresi贸n de los l贸bulos secundarios es cr铆tica.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/tipos%20de%20ventana%20y%20anchura%20FIR.png" align="center" width="660" height="500"/>
<div align="center"> <i>Figura 3. Comparaci贸n de ventanas creadas para aplicarlas en filtros FIR [4].</i></div>
<p>
 
</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/tipos%20de%20ventana%20y%20anchura%20FIR.png"> <i>Figura 4. Caracter铆sticas en el dominio de frecuencia de las ventanas [4].</i></div>
<p>


### Filtros IIR (Respuesta al Impulso Infinita): 

Filtro recursivo que calcula su salida utilizando tanto las entradas actuales como las anteriores y las salidas previas. Este tipo de filtro incorpora un mecanismo de retroalimentaci贸n debido al uso de valores anteriores de la salida en su estructura. El dise帽o del filtro IIR implica determinar la funci贸n de transferencia de pulso que cumpla con los criterios especificados para el filtro. Este dise帽o se puede realizar desarrollando primero un prototipo anal贸gico y luego transform谩ndolo a una funci贸n de transferencia de pulso, o dise帽ando directamente en el dominio digital [4], [7].

 </p>
<p align="center">
 <img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/IIR%20FILTER%20IMAGE.gif">
<h5 align="center">
  <i>Figura 5.Arquitectura de los filtros IIR [7].</i></div>

#### Tipos de filtro:

1. Bessel: Se usan para reducir la distorsi贸n de fase no lineal en filtros IIR. Tienen una respuesta m谩ximamente plana en magnitud y fase, lo que significa una atenuaci贸n uniforme en todas las frecuencias y una fase casi lineal en la banda de paso. Sin embargo, necesitan filtros de alto orden, lo que limita su uso. Son preferidos cuando se requiere una atenuaci贸n uniforme y una transici贸n suave entre la banda de paso y la de parada [8].
2. Butterworth: tienen una respuesta suave en todas las frecuencias y disminuyen de manera constante desde las frecuencias de corte. Son "maximally flat", con una respuesta ideal de unidad en la banda de paso y cero en la banda de parada. Aunque su transici贸n entre la banda de paso y la banda de parada es lenta, ofrecen una respuesta de frecuencia suave y constante. La empinada transici贸n aumenta con el orden del filtro, lo que permite aproximarse a la respuesta ideal del filtro paso bajo [9] .
3. Chebyshev: Minimiza el error m谩ximo en la banda de paso al permitir ondulaciones equirr铆tmicas en esta regi贸n. Tienen una respuesta en magnitud mon贸tonamente decreciente en la banda de parada y una pendiente de atenuaci贸n m谩s pronunciada que los filtros de Butterworth. La frecuencia de corte para los filtros de Chebyshev se define como el final de la banda de paso, donde la respuesta est谩 1 dB por debajo de su nivel m谩ximo y decrece mon贸tonamente m谩s all谩 de este punto [10].
4. El铆ptica (Cauer): La ventana el铆ptica se utiliza para dise帽ar filtros con una respuesta en frecuencia 贸ptima en t茅rminos de selectividad y ancho de banda de transici贸n, a costa de tener ondulaciones tanto en la banda de paso como en la banda de parada. Es ideal para aplicaciones donde se requiere un alto grado de selectividad y una r谩pida transici贸n entre la banda de paso y la banda de parada, como en filtros de alta frecuencia y sistemas de sonar.


</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="link" align="center" width="660" height="500"/>
<div align="center"> <i>Figura 6. Filtros IIR [X].</i></div>
<p>

  

<a id = "matereiales"></a>  
<h2 style = "text-align: center;">Materiales y equipos</h2>

<div align="center">

|   **Dispositivo**   | **Descripci贸n** |  **Imagen**  |
|:-------------------:|:---------------:|:------------:|
|      laptop      | Una laptop equipada con Python, un lenguaje de programaci贸n vers谩til y poderoso, es ideal para realizar tareas de programaci贸n y an谩lisis de datos en entornos de laboratorio. |<img width="200" height="150" src="fotolaptop">|

</div>


<a id = "metodo" style></a>
<h2 style = "text-align: center;">Metodolod铆a</h2>

### Paso 1
</p>
blibli
</p>

</p>
 <p align="center">
<p>
   <img src="bli" width="500" height="300"/>
</p>

<div align="center"> <i>Figura x. ji Elaboraci贸n propia.</i></div>
<p>
 



### Paso 2
</p>
blibli

</p>

</p>
 <p align="center">
<p>
   <img src="jo" width="500" height="300"/>
</p>
<h5 align="center">
  Figura x. ju Elaboraci贸n propia.
</h5>
</p>

### Paso 3
</p>
bbibki
</p>


### Paso 4
</p>
blibli
</p>



<a id = "archivosenal"></a>
<h2 style = "text-align: center;">Archivos de los datos de la se帽al ploteada</h2>
</h5>

### Archivos texto
#### ECG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/NormalBreath30s.txt)</p>
2. [Registro 2 - Bitalino: Inhalando/Manteniendo/Exhalando por 5s](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/InHoldEx5s.txt)</p>
3. [Registro 3 - Bitalino: Despu茅s del burpee](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/ReposandoBurpee30s.txt)</p>
#### EEG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_PrimeroOsjoscerrados.txt)</p>
2. [Registro 2 - Bitalino: Abriendo/Cerrando ojos](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_2_5s.txt)</p>
3. [Registro 3 - Bitalino: Resolviendo ejercicios](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/ejmate.txt)</p>
#### EMG
1. [Registro 1 - Bitalino: Reposo/ontracci贸n leve/ontracci贸n fuerte](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/3.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EMG/text_EMG.txt)</p>

### Archivos python 

1. [C贸digo principal - IIR y FIR ](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/FILTROS_corregido.ipynb)</p>

<br />

<a id = "python"></a>
<h2 style = "text-align: center;">Ploteo de la se帽al en Python</h2>
</p>

AQUI TENEMOS QUE EXPLICAR PORQUE ELEGIMOS BUTTER Y HAMMING (vi que lo estaban haciendo en el docs aqui pegar)

</p>

### Para las se帽ales de ECG 

#### Reposo :

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Actividad en reposo
</h5>



Interpretaci贸n:
blibli.



#### Inhalando/Manteniendo/Exhalando por 5s

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_IN_HOLD_EX.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Inhalando/Manteniendo/Exhalando por 5s
</h5>

Interpretaci贸n:

blibli

#### Despu茅s del ejercicio f铆sico
</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/ECG_POST_BURPEE.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Despu茅s del ejercicio f铆sico 
</h5>

Interpretaci贸n:

blibli

### Para las se帽ales de EEG 

#### Reposo :

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Actividad en reposo
</h5>



Interpretaci贸n:
blibli.



#### Abrir y cerrar los ojos  5s 

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_AB_CER_OJOS.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Abrir y cerrar los ojos  5s c/u
</h5>

Interpretaci贸n:

blibli

#### Resolviendo ejercicios matematicos 
</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EEG_MATE.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Resolviendo ejercicios matematicos  
</h5>

Interpretaci贸n:

blibli


### Para las se帽ales de EMG 

#### Reposo :

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_REPOSO.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Actividad en reposo
</h5>



Interpretaci贸n:
blibli.



#### Contracci贸n leve

</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CONT_LEVE.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Contracci贸n leve
</h5>

Interpretaci贸n:

blibli

#### Contracci贸n fuerte
</p>
<p align="center">
<img width="660" height="400" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/EMG_CONT_FUERTE.jpg">
</p>
<h5 align="center">
  Figura y: Se帽al obtenida en python: Contracci贸n fuerte
</h5>

Interpretaci贸n:

blibli






<a id = "explic"></a>
<h2 style = "text-align: center;">Resumen y Discusi贸n</h2>
blibli







<a id = "Bibliograf铆a"></a>
<h2 style = "text-align: center;">Bibliograf铆a</h2>
poner las blibiiogr
