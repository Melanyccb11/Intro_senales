<h1 style="text-align: center;">Laboratorio 6: Filtrado de Señales Biológicas</h1>

</h3>Nombre de los Integrantes y código:

1. Melany Cama Bahamonde 72128361
2. Alessandra Valle Montoya  71098563
3. Catherine Boggio Vidal 71329106
4. Juan Jose Sandoval Barrantes 74145560
</p>

<h2 style="text-align: center;">Tabla de Contenidos</h2>

1. [Objetivos](#objetivo)
2. [Introducción](#intro)
3. [Materiales y equipos](#matereiales)
4. [Metodología](#metodo)
5. [Archivo de los datos de la señal ploteada](#archivosenal)
6. [Ploteo de la señal en Python](#python)
7. [Resumen y Discusión](#explic)
8. [Bibliografía](#Bibliografía)

<a id = "objetivo" style></a>
<h2 style = "text-align: center;">Objetivos</h2>
- Realizar la transformada Wavelet para filtrar señales de EMG, ECG, EEG.<br />

<a id = "intro" style></a>
<h2 style = "text-align: center;">Introducción</h2>

La transformada wavelet constituye una herramienta esencial en el análisis y procesamiento de señales, gracias a su capacidad para descomponer una señal en componentes de diversas frecuencias y localizaciones temporales, y posteriormente reconstruir una señal más limpia. Esta transformada ofrece una representación multirresolución, lo que permite realizar un análisis simultáneo en los dominios del tiempo y la frecuencia.[1]

### Descomposicion y reconstrucción : 

La descomposición de funciones y su reconstrucción de la señal a través de filtros Wavelet puede ser computada mediante el algoritmo piramidal donde, en cada nivel de resolución, la función se descompone en una aproximación detalle más una aproximación gruesa llamada tendencia.[1]  Estos son esenciales para extraer los coeficientes wavelet y representar las características de la señal.

- Descomposición:
  Filtros de Análisis: Se aplican filtros de paso bajo y paso alto a la señal original, generando coeficientes de aproximación (componentes de baja frecuencia) y coeficientes de detalle (componentes de alta frecuencia).
  Multinivel: Este proceso puede repetirse a varios niveles, descomponiendo la señal en componentes de frecuencia progresivamente más bajas.

- Reconstrucción:
  Filtros de síntesis: Los coeficientes filtrados se utilizan para reconstruir la señal original. Este proceso implica la combinación de las componentes de baja y alta frecuencia.

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/filter%20structure.png"> 
<h5 align="center">
  <i>Figura 1. Algoritmo piramidal[2].</i></div>
<p></h5>



### Elección del método de Filtrado:

- Método del umbral: Para la eliminación de ruido, la señal contaminada será descompuesta mediante la transformada wavelet. Los coeficientes útiles se retendrán, mientras que los innecesarios se establecerán en cero. El umbral seleccionado puede ser suave (soft) o duro (hard). Según el método propuesto por Donoho, este umbral para el filtrado en una base ortonormal se determina mediante la Fórmula1, donde σ es la desviación estándar del ruido con distribución gaussiana de los coeficientes de la transformada, y N es el número de datos analizados.[3]


 </p>
<p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/umbral.png">
 <p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/metodos%20del%20filtro.png">
<h5 align="center">
  <i>Fórmula 1. Obtención del umbral requerido </i></div>
<br /> </p></h5>


- Eliminación de coeficientes: Este método se emplea para procesar señales biológicas. La señal contaminada se descompone mediante la transformada wavelet y se eliminan los coeficientes irrelevantes, conservando solo aquellos que representan las características útiles de la señal. Este método no se basa en el suavizado, sino en la eliminación directa de los coeficientes de ruido. Los coeficientes restantes se utilizan para reconstruir la señal, preservando su integridad. En la Figura 1 se muestra el procedimiento para aplicar este filtro y reconstruir la señal utilizando los coeficientes retenidos.[4]


### Filtro a utilizar: Wavelets de Daubechies (db):[5]

FALTA PONEEEEEEEEEEER

  

<a id = "matereiales"></a>  
<h2 style = "text-align: center;">Materiales y equipos</h2>

<div align="center">

|   **Dispositivo**   | **Descripción** |  **Imagen**  |
|:-------------------:|:---------------:|:------------:|
|      laptop      | Una laptop equipada con Python, un lenguaje de programación versátil y poderoso, es ideal para realizar tareas de programación y análisis de datos en entornos de laboratorio. |<img width="200" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/68af906e-92c2-4096-ab4c-06e60cba53f1.jpg">|

</div>


<a id = "metodo" style></a>
<h2 style = "text-align: center;">Metodolodía</h2>

#### Adquisición de Señales
Las señales biológicas fueron adquiridas durante diferentes condiciones experimentales, tales como estado basal (reposo), actividad 1 y actividad 2. Estas señales se almacenaron en formato de texto y se muestrearon a una frecuencia de 1000 Hz.


#### Aplicación del Filtro Wavelet
Para el procesamiento de las señales biológicas, se implementó un enfoque basado en la transformada wavelet, utilizando específicamente la wavelet de Daubechies debido a sus propiedades de simetría y efectividad en el manejo de señales no estacionarias. El proceso se divide en varias etapas clave:

1. Eleccion del método: Toama de decisón entre técnica de umbralización o eliminación de coeficientes basado en artículos
2. Descomposición: La señal biológica se descompuso utilizando la transformada wavelet Daubechies (por ejemplo, db4). Este proceso permite separar las componentes de frecuencia de la señal en diferentes niveles, aislando los detalles y elementos de interés, es decir, los coeficientes.
3. Reconstrucción: Utilizando los coeficientes wavelet modificados, se reconstruyó la señal filtrada. Este paso es crucial para asegurar que los elementos esenciales de la señal se mantengan claros y bien definidos, facilitando su identificación y análisis.

</p>

<a id = "archivosenal"></a>
<h2 style = "text-align: center;">Archivos de los datos de la señal ploteada</h2>
</h5>

#### ECG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/NormalBreath30s.txt)</p>
2. [Registro 2 - Bitalino: Inhalando/Manteniendo/Exhalando por 5s](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/InHoldEx5s.txt)</p>
3. [Registro 3 - Bitalino: Después del burpee](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/ReposandoBurpee30s.txt)</p>
#### EEG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_PrimeroOsjoscerrados.txt)</p>
2. [Registro 2 - Bitalino: Abriendo/Cerrando ojos](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_2_5s.txt)</p>
3. [Registro 3 - Bitalino: Resolviendo ejercicios](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/ejmate.txt)</p>
#### EMG
1. [Registro 1 - Bitalino: Reposo/ontracción leve/ontracción fuerte](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/3.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EMG/text_EMG.txt)</p>

### Archivos python 

1. [Código principal - IIR y FIR ](SUBIRLO ESTA ENCHAT)</p>


<a id = "python"></a>
<h2 style = "text-align: center;">Ploteo de la señal en Python</h2>
</p>

PEQUEÑA INTRODUCCION SOOBRE BENEFECIES DE ESTOS FILTROS EN SEÑALES BIO Y SU BUEN USO BLABLA</p>


## Para las señales de ECG 
En las siguientes figuras se observará el análisis y procesamiento de señales de ECG utilizando un filtro wavelet basado en la transformada Daubechies y el método de umbralización. El objetivo principal es ilustrar cómo se descompone una señal cruda en sus componentes de frecuencia a través de varios niveles de detalle y aproximación, y cómo estos coeficientes pueden ser utilizados para filtrar la señal y eliminar el ruido.<p>

Según la literatura[ECG-docs] se deben analizarán los coeficientes resultantes de una descomposición en 8 niveles, permitiendo observar cómo la señal original se desglosa en diferentes bandas de frecuencia, teniendo en cuenta que el valor de la umbral depende de la cantidad de elemtentos que tiene la señal determinada por la Fórmula 1. Luego se compararán la señal original y la señal filtrada para demostrar la eficacia del filtro wavelet en la reducción del ruido.<p>

</p>



### Reposo :
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG1_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG1.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[ECG]:
La señal de ECG filtrada utilizando la transformada wavelet Daubechies con umbralización a 8 niveles muestra una notable reducción de ruido, manteniendo los picos P, QRS y T claramente definidos. Este método es eficaz para eliminar componentes de alta frecuencia que corresponden a artefactos y ruido, mientras preserva las características esenciales de la señal. Al analizar los coeficientes wavelet, se observa que los niveles 1 a 3 capturan principalmente ruido, que es eliminado tras la umbralización, resultando en coeficientes cercanos a cero. Los niveles 4 a 6 incluyen detalles importantes y algunos artefactos; la umbralización aquí es más selectiva, reteniendo información relevante y reduciendo la amplitud de los coeficientes sin perder las características clave. Los niveles mas altos son esenciales para la reconstrucción precisa de la señal. En una persona en reposo, la señal de ECG es relativamente estable y menos propensa a interferencias externas.

### Inhalando/Manteniendo/Exhalando por 5s
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG2_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG2.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel

### Después del ejercicio físico
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG3_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG3.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel

## Para las señales de EEG 

bliblibli

</p>

<p>

### Reposo :

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG1_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG1.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel




### Abrir y cerrar los ojos  5s 

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG2_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG2.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel



### Resolviendo ejercicios matematicos 
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG3_cof.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG3.jpg"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel



## Para las señales de EMG 

bliblibli

</p>
<p>


### Reposo :

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel



### Contracción leve

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel


### Contracción fuerte
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="link"> 
<h5 align="center">
  <i>Figura 3?: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[15]:
bleblebel

<a id = "explic"></a>
<h2 style = "text-align: center;">Resumen y Discusión</h2>

resume todo lo visto balbalbalblablablblabaklablabl

<a id = "Bibliografía"></a>
<h2 style = "text-align: center;">Bibliografía</h2>

[1]	En el docs estan las que use

