<h1 style="text-align: center;">Laboratorio 7: Filtrado de Señales Biológicas con Wavelet</h1>

</h3>Nombre de los Integrantes y código:

1. Melany Cama Bahamonde 72128361
2. Alessandra Valle Montoya  71098563
3. Catherine Boggio Vidal 71329106
4. Juan Jose Sandoval Barrantes 74145560
</p>

<h2 style="text-align: center;">Tabla de Contenidos</h2>

1. [Objetivos](#objetivo)
2. [Introducción](#intro)
3. [Materiales y equipos](#matereiales)
4. [Metodología](#metodo)
5. [Archivo de los datos de la señal ploteada](#archivosenal)
6. [Ploteo de la señal en Python](#python)
7. [Resumen y Discusión](#explic)
8. [Bibliografía](#Bibliografía)

<a id = "objetivo" style></a>
<h2 style = "text-align: center;">Objetivos</h2>
- Realizar la transformada Wavelet para filtrar señales de EMG, ECG, EEG.<br />

<a id = "intro" style></a>
<h2 style = "text-align: center;">Introducción</h2>

La transformada wavelet constituye una herramienta esencial en el análisis y procesamiento de señales, gracias a su capacidad para descomponer una señal en componentes de diversas frecuencias y localizaciones temporales, y posteriormente reconstruir una señal más limpia. Esta transformada ofrece una representación multirresolución, lo que permite realizar un análisis simultáneo en los dominios del tiempo y la frecuencia[1]. Existen dos tipos, la continua y la discreta, pero por motivos limitación computacional usaremos las discretas. Los tipos de wavelets discretas son los siguientes [2]: 

- Wavelet de Haar: es la más simple y se caracteriza por su fácil implementación. Sin embargo, su discontinuidad puede ser una desventaja en aplicaciones que requieren una reconstrucción suave de la señal.
- Wavelets de Daubechies: son ortogonales y tienen soporte compacto, lo que las hace ideales para el análisis de señales de soporte finito. Estas wavelets se designan como DN, donde N indica el número de coeficientes no nulos.
- Wavelets de Symlet: son una modificación de las wavelets de Daubechies para hacerlas más simétricas, lo que es importante en aplicaciones donde la simetría es crucial para evitar artefactos en la reconstrucción de la señal.
- Wavelets de Coiflet: tienen una mejor simetría y sus coeficientes de baja frecuencia tienen propiedades de vanishing moments, útiles para eliminar tendencias de baja frecuencia en la señal.
- Wavelets Bior: son biortogonales y permiten una reconstrucción exacta con propiedades de simetría, siendo frecuentemente utilizadas en procesamiento y compresión de imágenes.
- Wavelets de Meyer: tienen un soporte infinito pero son muy suaves, ofreciendo una buena localización en frecuencia, útiles en aplicaciones donde la suavidad y la precisión en la frecuencia son importantes.

Para el desarrollo de este laboratorio hemos decidido usar el filtro Wavelets de Daubechies.


### Descomposicion y reconstrucción : 

La descomposición de funciones y su reconstrucción de la señal a través de filtros Wavelet puede ser computada mediante el algoritmo piramidal donde, en cada nivel de resolución, la función se descompone en una aproximación detalle más una aproximación gruesa llamada tendencia.[1]  Estos son esenciales para extraer los coeficientes wavelet y representar las características de la señal.

- Descomposición:
  Filtros de Análisis: Se aplican filtros de paso bajo y paso alto a la señal original, generando coeficientes de aproximación (componentes de baja frecuencia) y coeficientes de detalle (componentes de alta frecuencia).
  Multinivel: Este proceso puede repetirse a varios niveles, descomponiendo la señal en componentes de frecuencia progresivamente más bajas.

- Reconstrucción:
  Filtros de síntesis: Los coeficientes filtrados se utilizan para reconstruir la señal original. Este proceso implica la combinación de las componentes de baja y alta frecuencia.

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/filter%20structure.png"> 
<h5 align="center">
  <i>Figura 1. Algoritmo piramidal[2].</i></div>
<p></h5>



### Elección del método de Filtrado:

- Método del umbral: Para la eliminación de ruido, la señal contaminada será descompuesta mediante la transformada wavelet. Los coeficientes útiles se retendrán, mientras que los innecesarios se establecerán en cero. El umbral seleccionado puede ser suave (soft) o duro (hard). Según el método propuesto por Donoho, este umbral para el filtrado en una base ortonormal se determina mediante la Fórmula1, donde σ es la desviación estándar del ruido con distribución gaussiana de los coeficientes de la transformada, y N es el número de datos analizados.[3]


 </p>
<p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/umbral.png">
 <p align="center">
 <img width="250" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/metodos%20del%20filtro.png">
<h5 align="center">
  <i>Fórmula 1. Obtención del umbral requerido </i></div>
<br /> </p></h5>


- Eliminación de coeficientes [4]: Este proceso implica descomponer la señal original en coeficientes de aproximación y detalle utilizando filtros paso-bajo y paso-alto. A través de este proceso iterativo, se obtienen matrices de coeficientes en diferentes niveles de resolución. Para eliminar el ruido, se identifican y anulan los coeficientes de detalle que se consideran no esenciales. Esta decisión se basa en un umbral predefinido, que puede determinarse mediante análisis estadísticos o conocimiento previo sobre la señal. Generalmente, los coeficientes de detalle en los niveles más altos, que contienen ruido de alta frecuencia, son los que se eliminan. Una vez anulados los coeficientes irrelevantes, la señal se reconstruye aplicando la transformada wavelet inversa a los coeficientes restantes. Esto da como resultado una señal con menos ruido y que conserva las características importantes de la original. Este método es especialmente útil en dispositivos con recursos computacionales limitados, como una laptop.
Un ejemplo práctico es el uso de wavelets de Daubechies (como DAUB12 y DAUB20) en el procesamiento de imágenes. Al eliminar los coeficientes de detalle en los niveles más altos y aplicar la transformada inversa, se logra una reducción significativa del ruido en la imagen reconstruida, mejorando su claridad y calidad visual.



### Filtro a utilizar: Wavelets de Daubechies (db):

Las wavelets de Daubechies se caracterizan por tener un soporte compacto y una estructura ortogonal, lo que garantiza que la transformada sea estable y eficiente desde el punto de vista computacional. Entre las versiones de Daubechies, como db2, db3, db4, etc., se elige la wavelet específica según las características de la señal a analizar. La wavelet db2, por ejemplo, es adecuada para señales con menor suavidad, mientras que versiones como db10 proporcionan una mejor aproximación en señales más complejas y suaves [4].

Las propiedades que tiene, como su ortogonalidad y su soporte compacto, las hacen ideales para el procesamiento de señales en sistemas con recursos computacionales limitados, como una laptop. Además, la capacidad de estas wavelets para representar las señales de manera eficiente y precisa, reduciendo el error de aproximación, es crucial en aplicaciones prácticas donde la precisión y la eficiencia son esenciales [4].

  

<a id = "matereiales"></a>  
<h2 style = "text-align: center;">Materiales y equipos</h2>

<div align="center">

|   **Dispositivo**   | **Descripción** |  **Imagen**  |
|:-------------------:|:---------------:|:------------:|
|      laptop      | Una laptop equipada con Python, un lenguaje de programación versátil y poderoso, es ideal para realizar tareas de programación y análisis de datos en entornos de laboratorio. |<img width="200" height="150" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/6.%20Filtros%20IIR%20y%20FIR/Im%C3%A1genes/68af906e-92c2-4096-ab4c-06e60cba53f1.jpg">|

</div>


<a id = "metodo" style></a>
<h2 style = "text-align: center;">Metodolodía</h2>

#### Adquisición de Señales
Las señales biológicas fueron adquiridas durante diferentes condiciones experimentales, tales como estado basal (reposo), actividad 1 y actividad 2. Estas señales se almacenaron en formato de texto y se muestrearon a una frecuencia de 1000 Hz.


#### Aplicación del Filtro Wavelet
Para el procesamiento de las señales biológicas, se implementó un enfoque basado en la transformada wavelet, utilizando específicamente la wavelet de Daubechies debido a sus propiedades de simetría y efectividad en el manejo de señales no estacionarias. El proceso se divide en varias etapas clave:

1. Eleccion del método: Toma de decisón entre técnica de umbralización o eliminación de coeficientes basado en artículos
2. Descomposición: La señal biológica se descompuso utilizando la transformada wavelet Daubechies (por ejemplo, db4). Este proceso permite separar las componentes de frecuencia de la señal en diferentes niveles, aislando los detalles y elementos de interés, es decir, los coeficientes.
3. Reconstrucción: Utilizando los coeficientes wavelet modificados, se reconstruyó la señal filtrada. Este paso es crucial para asegurar que los elementos esenciales de la señal se mantengan claros y bien definidos, facilitando su identificación y análisis.

</p>

<a id = "archivosenal"></a>
<h2 style = "text-align: center;">Archivos de los datos de la señal ploteada</h2>
</h5>

#### ECG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/NormalBreath30s.txt)</p>
2. [Registro 2 - Bitalino: Inhalando/Manteniendo/Exhalando por 5s](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/InHoldEx5s.txt)</p>
3. [Registro 3 - Bitalino: Después del burpee](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/4.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20ECG/Archivo%20texto/ReposandoBurpee30s.txt)</p>
#### EEG
1. [Registro 1 - Bitalino: Reposo](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_PrimeroOsjoscerrados.txt)</p>
2. [Registro 2 - Bitalino: Abriendo/Cerrando ojos](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/EEG_2_5s.txt)</p>
3. [Registro 3 - Bitalino: Resolviendo ejercicios](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/5.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EEG/Archivos%20Texto/ejmate.txt)</p>
#### EMG
1. [Registro 1 - Bitalino: Reposo/ontracción leve/ontracción fuerte](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/3.%20Adquisi%C3%B3n%20de%20Se%C3%B1ales%20EMG/text_EMG.txt)</p>

### Archivos python 

1. [Código principal - IIR y FIR ](https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Filtro_Wavelet_listo.ipynb)</p>


<a id = "python"></a>
<h2 style = "text-align: center;">Ploteo de la señal en Python</h2>
</p>

Python es un lenguaje de programación de alto nivel que es fácil de aprender y usar, lo que lo hace ideal para trazar la transformada wavelet. Con librerías como PyWavelets y Matplotlib, Python permite realizar la transformada wavelet y visualizarla de manera eficiente. La transformada wavelet es una herramienta flexible y adaptable que es crucial para el análisis de señales, especialmente las no estacionarias. A diferencia de la Transformada de Fourier, la Transformada Wavelet Continua proporciona información en el dominio de la frecuencia y del tiempo, lo que la hace útil para señales periódicas que cambian con el tiempo. En resumen, Python ofrece una plataforma fácil de usar, flexible y potente para trabajar con la transformada wavelet [5].



## Para las señales de ECG 
En las siguientes figuras se observará el análisis y procesamiento de señales de ECG utilizando un filtro wavelet basado en la transformada Daubechies y el método de umbralización. El objetivo principal es ilustrar cómo se descompone una señal cruda en sus componentes de frecuencia a través de varios niveles de detalle y aproximación, y cómo estos coeficientes pueden ser utilizados para filtrar la señal y eliminar el ruido.<p>

Según la literatura[6] se deben analizarán los coeficientes resultantes de una descomposición en 8 niveles, permitiendo observar cómo la señal original se desglosa en diferentes bandas de frecuencia. En este filtrado de eliminan los niveles 1, 2 y el coeficiente madre del nivel 8, seguido posterormente de la reconstrucción de la señal. Luego se compararán la señal original y la señal filtrada para demostrar la eficacia del filtro wavelet en la reducción del ruido.<p>

</p>



### Reposo :
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG1_cof.jpg"> 
<h5 align="center">
  <i>Figura 2: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG1.jpg"> 
<h5 align="center">
  <i>Figura 3: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación[6]:
La señal de ECG filtrada utilizando la transformada wavelet Daubechies con umbralización a 8 niveles muestra una notable reducción de ruido, manteniendo los picos P, QRS y T claramente definidos. Este método es eficaz para eliminar componentes de alta frecuencia que corresponden a artefactos y ruido, mientras preserva las características esenciales de la señal. Al analizar los coeficientes wavelet, se observa que los niveles 1 a 3 capturan principalmente ruido, que es eliminado tras la umbralización, resultando en coeficientes cercanos a cero. Los niveles 4 a 6 incluyen detalles importantes y algunos artefactos; la umbralización aquí es más selectiva, reteniendo información relevante y reduciendo la amplitud de los coeficientes sin perder las características clave. Los niveles mas altos son esenciales para la reconstrucción precisa de la señal. En una persona en reposo, la señal de ECG es relativamente estable y menos propensa a interferencias externas.

### Inhalando/Manteniendo/Exhalando por 5s
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG2_cof.jpg"> 
<h5 align="center">
  <i>Figura 4: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG2.jpg"> 
<h5 align="center">
  <i>Figura 5: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
La señal original muestra picos QRS prominentes y variaciones en la línea de base, reflejando la actividad eléctrica del corazón y la respuesta al ciclo respiratorio. El ritmo cardíaco muestra una frecuencia aumentada, con variaciones en amplitud y frecuencia de los picos [7].

Tras aplicar la wavelet de Daubechies para filtrar la señal, se reduce significativamente el ruido en la línea de base, haciendo la señal más clara y precisa. Los picos QRS y otros componentes importantes del ECG se mantienen bien definidos, lo que indica la eficacia del filtro wavelet en eliminar el ruido sin perder información crítica. La variabilidad en la línea de base, debida al ciclo respiratorio, se observa más claramente en la señal filtrada, permitiendo un análisis más detallado de los efectos de la respiración en la actividad cardíaca [4].

En términos de diagnóstico, las variaciones en la frecuencia y amplitud del ECG durante la respiración controlada pueden indicar una respuesta normal del sistema cardiovascular al esfuerzo respiratorio [7]. La clara visualización de la señal filtrada facilita la detección de posibles anomalías que requieren atención clínica adicional. 


### Después del ejercicio físico
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG3_cof.jpg"> 
<h5 align="center">
  <i>Figura 6: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/ECG3.jpg"> 
<h5 align="center">
  <i>Figura 7: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
1. Coeficiente (N=0):Captura las frecuencias más altas de la señal original, incluyendo una gran cantidad de ruido.
2. Coeficiente (N=1 a N=2): Continúan mostrando componentes de alta frecuencia y una menor cantidad de ruido. Los picos QRS son aún visibles.
3. Coeficiente (N=3 a N=4): A medida que avanzamos a niveles más profundos, los coeficientes reflejan mejor las variaciones de baja frecuencia, reduciendo aún más el ruido y resaltando las características más globales de la señal.
4. Coeficiente (N=5 a N=6): En estos niveles, se capturan las tendencias más suaves y de muy baja frecuencia de la señal original, mostrando menos ruido y detalles finos de la señal.
5. Coeficiente (N=7 a N=8): Aquí, las variaciones de muy baja frecuencia y las tendencias generales de la señal son más prominentes.

El ejercicio físico intenso, como los burpees, provoca un aumento significativo en la frecuencia y amplitud de los picos QRS debido a la mayor demanda cardíaca. La señal original muestra una considerable variabilidad en la línea de base y un incremento en el ruido, reflejando la actividad física y la respuesta fisiológica del cuerpo al esfuerzo.En términos de diagnóstico, la clara visualización de la señal post ejercicio es crucial para detectar arritmias o cualquier otra anomalía que pueda surgir debido al esfuerzo físico [7]. 

La aplicación de la wavelet de Daubechies para filtrar la señal permite una reducción efectiva del ruido y una mejor visualización de los componentes esenciales del ECG. La señal filtrada facilita la identificación de posibles irregularidades que podrían no ser visibles en la señal original debido al ruido [4].


## Para las señales de EEG 

En las siguientes figuras se observará el análisis y procesamiento de señales de electroencefalograma (EEG) utilizando un filtro wavelet basado en la transformada Daubechies y el método de umbralización. El objetivo principal es ilustrar cómo se descompone una señal cruda de EEG en sus componentes de frecuencia a través de varios niveles de detalle y aproximación, y cómo estos coeficientes pueden ser utilizados para filtrar la señal y eliminar el ruido.

Según la literatura, se deben analizar los coeficientes resultantes de una descomposición en 8 niveles, permitiendo observar cómo la señal original se desglosa en diferentes bandas de frecuencia . Es importante tener en cuenta que el valor del umbral depende de la cantidad de elementos que tiene la señal, determinada por la Fórmula 1. Posteriormente, se compararán la señal original y la señal filtrada para demostrar la eficacia del filtro wavelet en la reducción del ruido [8].


</p>

<p>

### Reposo :

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG1_cof.jpg"> 
<h5 align="center">
  <i>Figura 8: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG1.jpg"> 
<h5 align="center">
  <i>Figura 9: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:

- Nivel 1 (N=1): El primer nivel de descomposición wavelet.
Los coeficientes de detalle en este nivel capturan las componentes de alta frecuencia y corta duración de la señal original.
Estos detalles pueden estar relacionados con artefactos de alta frecuencia o picos rápidos en la actividad cerebral.

- Nivel 2 (N=2): El segundo nivel de descomposición wavelet.
Los coeficientes aquí representan una mezcla de frecuencias intermedias y altas.
Se observan menos fluctuaciones rápidas comparado con el primer nivel, pero aún contiene información de eventos rápidos en la señal EEG.

- Nivel 3 (N=3): El tercer nivel de descomposición wavelet.
Los detalles en este nivel reflejan componentes de frecuencia más baja que en los niveles anteriores.
Puede capturar patrones de actividad cerebral que tienen una duración más larga y son menos frecuentes.

- Nivel 4 (N=4): El cuarto nivel de descomposición wavelet.
Representa componentes de frecuencia aún más bajas.
Este nivel puede mostrar las oscilaciones de actividad cerebral que duran más tiempo y que son características de estados más estables de reposo.

- Nivel 5 (N=5): El quinto nivel de descomposición wavelet.
Se centra en componentes de frecuencia baja a muy baja.
Aquí se pueden ver patrones que indican la actividad lenta y persistente de la señal EEG, típicos de un estado de reposo profundo.

- Nivel 6 (N=6): El sexto nivel de descomposición wavelet.
Los coeficientes de este nivel reflejan oscilaciones muy lentas de la actividad cerebral.
Estos detalles pueden estar asociados con ritmos cerebrales muy lentos y ondas delta, que son predominantes durante el sueño profundo.

- Nivel 7 (N=7): El séptimo nivel de descomposición wavelet.
Las fluctuaciones en este nivel son mínimas, indicando componentes de frecuencia extremadamente baja.
Estas pueden estar relacionadas con la actividad cortical más lenta y estable.

- Nivel 8 (N=8): El octavo nivel de descomposición wavelet.
Este nivel captura las componentes de frecuencia más baja presentes en la señal original.
Refleja la actividad cerebral de fondo muy estable y lenta, típica del reposo o sueño profundo.


### Abrir y cerrar los ojos  5s 

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG2_cof.jpg"> 
<h5 align="center">
  <i>Figura 10: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG2.jpg"> 
<h5 align="center">
  <i>Figura 11: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
- Nivel 0 (N=0):
Esta es la señal original, que muestra la actividad cerebral durante el proceso de abrir y cerrar los ojos.
Se observan fluctuaciones más marcadas que en la señal de reposo, reflejando la actividad cerebral inducida por los movimientos de los párpados.

- Nivel 1 (N=1): El primer nivel de descomposición wavelet.
Los coeficientes de detalle en este nivel capturan las componentes de alta frecuencia y corta duración.
Estos detalles son más prominentes y frecuentes, posiblemente reflejando artefactos debido al parpadeo y movimientos oculares.

- Nivel 2 (N=2): El segundo nivel de descomposición wavelet.
Los coeficientes aquí representan una mezcla de frecuencias intermedias y altas.
Se observan fluctuaciones que capturan tanto la actividad cerebral rápida como los artefactos inducidos por el parpadeo.

- Nivel 3 (N=3): El tercer nivel de descomposición wavelet.
Los detalles en este nivel reflejan componentes de frecuencia más baja que en los niveles anteriores.
Este nivel muestra patrones más definidos de actividad cerebral en respuesta a los movimientos de los ojos.

- Nivel 4 (N=4): El cuarto nivel de descomposición wavelet.
Representa componentes de frecuencia baja.
Las fluctuaciones en este nivel son más lentas y reflejan la actividad cerebral sostenida durante el abrir y cerrar de los ojos.

- Nivel 5 (N=5): El quinto nivel de descomposición wavelet.
Se centra en componentes de frecuencia baja a muy baja.
Este nivel captura las oscilaciones de frecuencia más baja, que son menos afectadas por los artefactos de parpadeo y reflejan la actividad cerebral más estable.

- Nivel 6 (N=6): El sexto nivel de descomposición wavelet.
Los coeficientes en este nivel reflejan oscilaciones muy lentas de la actividad cerebral.
Estas oscilaciones pueden estar asociadas con la actividad cortical lenta y los ritmos delta.

- Nivel 7 (N=7): El séptimo nivel de descomposición wavelet.
Las fluctuaciones en este nivel son mínimas, indicando componentes de frecuencia extremadamente baja.
Estas pueden estar relacionadas con la actividad cortical de fondo muy lenta y estable.

- Nivel 8 (N=8): El octavo nivel de descomposición wavelet.
Este nivel captura las componentes de frecuencia más baja presentes en la señal original.
Refleja la actividad cerebral de fondo muy estable y lenta.


### Resolviendo ejercicios matematicos 
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG3_cof.jpg"> 
<h5 align="center">
  <i>Figura 12: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7.%20Filtro%20Wavelet/Im%C3%A1genes/EEG3.jpg"> 
<h5 align="center">
  <i>Figura 13: Comparación de señal original con filtrada. [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:

- Nivel 0 (N=0):
Esta es la señal original, que muestra la actividad cerebral durante la resolución de ejercicios matemáticos.
Se observan fluctuaciones que reflejan la actividad cerebral intensa y sostenida, característica del procesamiento cognitivo durante tareas matemáticas.

- Nivel 1 (N=1): El primer nivel de descomposición wavelet.
Los coeficientes de detalle en este nivel capturan las componentes de alta frecuencia y corta duración.
Se observan fluctuaciones significativas que pueden estar relacionadas con picos de actividad neuronal rápida, posiblemente debido al pensamiento crítico y la resolución de problemas.

- Nivel 2 (N=2): El segundo nivel de descomposición wavelet.
Los coeficientes aquí representan una mezcla de frecuencias intermedias y altas.
Las fluctuaciones son menos pronunciadas pero aún muestran actividad cognitiva significativa, indicando procesamiento mental continuo.

- Nivel 3 (N=3): El tercer nivel de descomposición wavelet.
Los detalles en este nivel reflejan componentes de frecuencia más baja que en los niveles anteriores.
Muestran patrones de actividad cerebral más sostenida, reflejando la concentración y el enfoque necesarios para resolver problemas matemáticos.

- Nivel 4 (N=4): El cuarto nivel de descomposición wavelet.
Representa componentes de frecuencia baja.
Las fluctuaciones en este nivel son más estables, indicando una actividad cerebral constante y sostenida durante el pensamiento lógico y analítico.

- Nivel 5 (N=5): El quinto nivel de descomposición wavelet.
Se centra en componentes de frecuencia baja a muy baja.
Captura las oscilaciones de frecuencia más baja, que reflejan la actividad cerebral de fondo y los ritmos alfa que pueden estar presentes durante la resolución de problemas complejos.

- Nivel 6 (N=6): El sexto nivel de descomposición wavelet.
Los coeficientes en este nivel reflejan oscilaciones muy lentas de la actividad cerebral.
Estas oscilaciones pueden estar asociadas con la actividad cortical lenta, indicando un estado de concentración profunda.

- Nivel 7 (N=7): El séptimo nivel de descomposición wavelet.
Las fluctuaciones en este nivel son mínimas, indicando componentes de frecuencia extremadamente baja.
Estas pueden estar relacionadas con la actividad de fondo de la corteza cerebral.

- Nivel 8 (N=8): El octavo nivel de descomposición wavelet.
Este nivel captura las componentes de frecuencia más baja presentes en la señal original.
Refleja la actividad cerebral muy estable y lenta, probablemente relacionada con el mantenimiento de la atención y el enfoque prolongados.

## Para las señales de EMG 

En los siguientes gráficos se presenta el análisis y procesamiento de una señal de electromiografía (EMG) utilizando una descomposición wavelet con la transformada Daubechies. El objetivo principal es ilustrar cómo se descompone una señal cruda de EMG en sus componentes de frecuencia a través de varios niveles de detalle, permitiendo una evaluación detallada de la señal en términos de actividad muscular y eliminación de ruido.

Según la literatura, el análisis de señales EMG mediante descomposición wavelet es una técnica eficaz para distinguir diferentes bandas de frecuencia y evaluar la calidad de la señal. En este caso, se ha utilizado una descomposición en 5 niveles, permitiendo observar cómo la señal original se desglosa en diferentes componentes de detalle. Esto facilita la identificación de características específicas de la señal EMG, como picos de actividad muscular y posibles artefactos de ruido.

</p>
<p>


### Reposo :

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_RESTING.png"> 
<h5 align="center">
  <i>Figura 14: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_SIGNAL_X_FILTERED.png"> 
<h5 align="center">
  <i>Figura 15: Comparación de señal original con filtrada (visualizar de 0-10 s). [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
- Señal EMG Original (0-10s):
Esta es la señal original, que muestra la actividad muscular durante el estado de reposo en el intervalo de 0 a 10 segundos.
Se observan fluctuaciones mínimas en la señal, lo que es característico de un estado de reposo, donde la actividad muscular es muy baja o prácticamente nula.

- Coeficientes de Detalle Nivel 1:
Este nivel de descomposición wavelet captura las componentes de alta frecuencia y corta duración.
Las fluctuaciones observadas son muy sutiles, indicando la ausencia de actividad muscular rápida o artefactos de alta frecuencia, lo cual es coherente con el estado de reposo.

- Coeficientes de Detalle Nivel 2:
Los coeficientes de este nivel representan una mezcla de frecuencias intermedias y altas.
Las fluctuaciones son ligeramente más pronunciadas que en el nivel 1, pero siguen siendo pequeñas, reflejando la calma de la señal muscular en reposo.

- Coeficientes de Detalle Nivel 3:
Este nivel refleja componentes de frecuencia más baja que los niveles anteriores.
Muestra patrones de actividad muscular aún más estables y continuos, confirmando que no hay actividad muscular significativa durante el reposo.

- Coeficientes de Detalle Nivel 4:
Captura las componentes de frecuencia baja.
Las fluctuaciones aquí son más evidentes que en los niveles anteriores, pero aún muestran una actividad muy baja y estable, típica de la ausencia de contracción muscular.


### Contracción leve

</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_LOW_CONTRACTION.png"> 
<h5 align="center">
  <i>Figura 16: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_SIGNAL_X_FILTERED.png"> 
<h5 align="center">
  <i>Figura 17: Comparación de señal original con filtrada (visualizar de 13.5-15 s). [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
- Señal EMG Original (13.5-15s):
La señal original muestra la actividad muscular de una persona durante una contracción leve en el intervalo de 13.5 a 15 segundos.
Se observan fluctuaciones en la señal que reflejan la actividad muscular sostenida, aunque de baja intensidad, característica de una contracción leve.

- Coeficientes de Detalle Nivel 1:
Este nivel de descomposición wavelet captura las componentes de alta frecuencia y corta duración.
Las fluctuaciones son más pronunciadas que en el estado de reposo, indicando la presencia de actividad muscular rápida debido a la contracción leve.

- Coeficientes de Detalle Nivel 2:
Los coeficientes de este nivel representan una mezcla de frecuencias intermedias y altas.
Las fluctuaciones muestran una actividad muscular sostenida de intensidad moderada, lo cual es consistente con una contracción leve continua.

- Coeficientes de Detalle Nivel 3:
Este nivel refleja componentes de frecuencia más baja que los niveles anteriores.
Muestra patrones de actividad muscular más estables y continuos, reflejando la contracción leve y sostenida de los músculos.

- Coeficientes de Detalle Nivel 4:
Captura las componentes de frecuencia baja.
Las fluctuaciones aquí son más evidentes y muestran una actividad constante y sostenida, típica de una contracción muscular leve mantenida.


### Contracción fuerte
</h5>
 <p align="center" style="margin-bottom:0">
<img width="800" height="600" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_HIGH_CONTRACTION.png"> 
<h5 align="center">
  <i>Figura 18: Niveles de descomposición. [Elaboración propia]</i></div></h5>
<p>
</br>

</p>
</h5>
 <p align="center" style="margin-bottom:0">
<img width="600" height="500" src="https://github.com/Melanyccb11/Intro_senales/blob/main/ISB/Laboratorios/7. Filtro Wavelet/Imágenes/EMG_SIGNAL_X_FILTERED.png"> 
<h5 align="center">
  <i>Figura 19: Comparación de señal original con filtrada (visualizar de 15-18 s). [Elaboración propia]</i></div></h5>
<p>

#### Interpretación:
- Señal EMG Original (15.0-18.0s):
La señal original muestra la actividad muscular de una persona durante una contracción fuerte en el intervalo de 15.0 a 18.0 segundos.
Se observan fluctuaciones significativas y de alta amplitud en la señal, lo que refleja la intensa actividad muscular característica de una contracción fuerte.

- Coeficientes de Detalle Nivel 1:
Este nivel de descomposición wavelet captura las componentes de alta frecuencia y corta duración.
Las fluctuaciones en este nivel son muy pronunciadas, indicando la presencia de actividad muscular rápida y artefactos de alta frecuencia asociados con la contracción fuerte.

- Coeficientes de Detalle Nivel 2:
Los coeficientes de este nivel representan una mezcla de frecuencias intermedias y altas.
Las fluctuaciones son intensas y sostenidas, reflejando la alta actividad muscular continua durante la contracción fuerte.

- Coeficientes de Detalle Nivel 3:
Este nivel refleja componentes de frecuencia más baja que los niveles anteriores.
Muestra patrones de actividad muscular estables y de alta amplitud, confirmando la fuerte contracción muscular sostenida.

- Coeficientes de Detalle Nivel 4:
Captura las componentes de frecuencia baja.
Las fluctuaciones aquí son muy evidentes y muestran una actividad muscular constante y de alta intensidad, típica de una contracción muscular fuerte mantenida.

<a id = "explic"></a>
<h2 style = "text-align: center;">Resumen y Discusión</h2>

##### Resumen
Este estudio analizó señales de electrocardiografía (ECG), electroencefalografía (EEG) y electromiografía (EMG) en diversas condiciones. Utilizando la descomposición wavelet, se descompusieron las señales en múltiples niveles de detalle, permitiendo la identificación y evaluación de la actividad eléctrica y muscular. A continuación, se resumen y discuten los resultados obtenidos para cada tipo de señal en diferentes estados:

1. ECG (Electrocardiograma)
  - Reposo:
    La señal ECG mostró un patrón regular y estable, característico del ritmo cardíaco en reposo.
    Los coeficientes de detalle en los niveles más altos reflejaron la estabilidad del ritmo cardíaco.

  - Inhalando/Manteniendo/Exhalando:
    La señal mostró variaciones en la amplitud y frecuencia, reflejando los cambios en la actividad cardíaca debidos a las fases de la respiración.
    Los niveles de detalle mostraron fluctuaciones más marcadas, indicando el impacto de la respiración en el ritmo cardíaco.
  
  - Después de un Ejercicio Físico:  
    La señal ECG presentó un aumento significativo en la frecuencia cardíaca y la amplitud, indicativo de la actividad física reciente.
    Los coeficientes de detalle mostraron un patrón más caótico y menos regular, reflejando la recuperación del corazón tras el ejercicio.
    
2. EEG (Electroencefalograma)
  - Reposo:
    La señal EEG mostró una actividad cerebral moderada, con fluctuaciones suaves y regulares.
    Los niveles de detalle en las frecuencias bajas indicaron un estado de descanso y relajación.

  - Abrir y Cerrar los Ojos:
    La señal EEG presentó picos de actividad correspondientes a los momentos de apertura y cierre de los ojos.
    Los coeficientes de detalle en los niveles más altos reflejaron estas rápidas transiciones, mostrando la respuesta cerebral a los estímulos visuales.
  
  - Resolviendo Ejercicios Matemáticos:  
    La señal mostró un aumento en la actividad cerebral, con fluctuaciones más pronunciadas.
    Los niveles de detalle indicaron una mayor actividad cognitiva, reflejando el esfuerzo mental y el procesamiento de información.

3. EMG (Electromiografía)
  - Reposo:
    La señal EMG mostró una actividad muscular mínima y estable.
    Los coeficientes de detalle en todos los niveles confirmaron la ausencia de contracción muscular significativa.
  
  - Contracción Leve:  
    La señal mostró un aumento en las fluctuaciones, indicando una actividad muscular sostenida pero de baja intensidad.
    Los niveles de detalle reflejaron una actividad muscular constante, característica de una contracción leve mantenida.
  
  - Contracción Fuerte:  
    La señal presentó fluctuaciones significativas y de alta amplitud, indicativas de una intensa actividad muscular.
    Los coeficientes de detalle mostraron una actividad muscular sostenida y de alta intensidad, confirmando la fuerte contracción muscular.

##### Discusión
El análisis de señales ECG, EEG y EMG utilizando la descomposición wavelet permitió evaluar de manera detallada la actividad eléctrica y muscular en diferentes estados. Los resultados demuestran la eficacia de la descomposición wavelet para identificar y caracterizar diferentes niveles de actividad, proporcionando una comprensión más profunda de los procesos fisiológicos subyacentes. Este enfoque es útil para aplicaciones clínicas y de investigación, donde es crucial evaluar la calidad de la señal y extraer características relevantes para el diagnóstico y monitoreo de la salud.

<a id = "Bibliografía"></a>
<h2 style = "text-align: center;">Bibliografía</h2>

[1]	A. de T. de Señales, “Introducción a la Transformada Wavelet,” Dep. Señales Sist. Univ. Navar., 2006.

[2]	L. Chun-Lin, “A tutorial of the wavelet transform,” NTUEE Taiwan, vol. 21, no. 22, p. 2, 2010.

[3]	A. Fernández-Lavín and E. Ovando-Shelley, “Método de Filtrado con Wavelet para el Análisis de Señales,” in Geotechnical Engineering in the XXI Century: Lessons learned and future challenges: Proceedings of the XVI Pan-American Conference on Soil Mechanics and Geotechnical Engineering (XVI PCSMGE), 17-20 November 2019, Cancun, Mexico, IOS Press, 2019, p. 130.

[4]	N. Olivera Rodríguez, “Wavelets de Haar y Daubechies y sus aplicaciones,” 2018.

[5]	“A guide for using the Wavelet Transform in Machine Learning – ML Fundamentals.” Accessed: May 17, 2024. [Online]. Available: https://ataspinar.com/2018/12/21/a-guide-for-using-the-wavelet-transform-in-machine-learning/

[6]	P. Karthikeyan, M. Murugappan, and S. Yaacob, “ECG signal denoising using wavelet thresholding techniques in human stress assessment,” Int. J. Electr. Eng. Inform., vol. 4, no. 2, p. 306, 2012.

[7]	J. E. Hall, Guyton y Hall. Tratado de fisiología médica. Elsevier Health Sciences, 2011.

[8]	T. Olund, J. Duun-Henriksen, T. W. Kjaer, and H. B. Sorensen, “Automatic detection and classification of artifacts in single-channel EEG,” in 2014 36th Annual International Conference of the IEEE Engineering in Medicine and Biology Society, IEEE, 2014, pp. 922–925.

